---
layout: post
title: 机器学习算法 - 分类算法的评价
tags: [python, language, machine learning]
category: AI
---

## 混淆矩阵

在线性回归算法中提到，回归模型的评价方法有MSE，RMSE，MAE，$R^2$，而目前为止，分类问题的算法我们只用分类准确度来评价。 但分类准确度在某些场景下是有问题的，比如在一个癌症预测系统中，根据体检信息来判断是否有癌症。假如癌症产生的概率只有 0.1%，预测所有人都健康的，准确率已经达到了 99.9%，如果预测系统预测的准确率为 99.9%，则预测系统毫无意义；如果癌症产生的概率为 0.01%，预测所有人都健康，准确率已经达到 99.99%，99.9% 的准确率毫无意义。

因此，对于极度偏斜的数据（Skewed Data，数据极度偏斜到某一个类别），只使用分类准确度是不够的，我们可以使用混淆矩阵（Confusion Matrix）来评价这种极度偏斜数据。

二分类问题对应的混淆矩阵为：

- 0 - Negative，通常指大概率事情；1 - Positive，指的是我们关注的事情。
- 行代表真实值，列代表预测值

| 真实/预测 | 0                              | 1                             |
| --------- | ------------------------------ | ----------------------------- |
| 0         | TN。预测 Negative 正确的数量。 | FP。预测 Postive 错误的数量。 |
| 1         | FN。                           | TP。                          |

## 精准率和召回率

下面是 10000 个人群的癌症预测样本：

| 真实/预测 |      0      |     1     |
| :-------: | :---------: | :-------: |
|     0     | 9978 <BR>TN | 12 <BR>FP |
|     1     |   2<BR>FN   |  8<BR>TP  |

$$
精准率 = \frac {TP} {TP+FP}= \frac 8 {8+2}=40\%
$$

*精准率（precision）*指的是在预测值为 `1` 的数据中，预测正确的概率。对于癌症样本来说，在模型预测有20 个人患癌，但只有 8 人真正患癌，则精准率为 40%。$精准率 = \frac {TP} {TP+FP}$。

*召回率（recall）*指的是在真实值为 `1` 的数据中，成功预测的概率。对于癌症样本来说，有 10 个真正患癌的人中，模型预测了 8 个，则召回率为 80%。 $召回率=\frac {TP} {TP+FN}$。

在 10000 个癌症样本中，患癌的概率为 0.1%，假如模型预测所有人都是健康的，则对应的混淆矩阵为：

| 真实/预测 |      0      |    1     |
| :-------: | :---------: | :------: |
|     0     | 9990 <BR>TN | 0 <BR>FP |
|     1     |  10<BR>FN   | 0<BR>TP  |

准确率=99.9%，精准率=0/(0+0)=0，召回率=0/(10+0)=0。这样的预测模型是无意义的。

## 工具

- [LaTeX/Mathematics - Wikibooks, open books for an open world](https://en.wikibooks.org/wiki/LaTeX/Mathematics)
- [Play-with-Machine-Learning-Algorithms: Code of my MOOC Course](https://github.com/liuyubobobo/Play-with-Machine-Learning-Algorithms)

