---
layout: "post"
title: "Crypto"
date: "2016-12-16 22:08"
categories:
---

## 密钥

根据密钥的使用方法，可以将密钥分为对称密钥和非对称密钥。

- **对称密钥** （symmetric scypotography） 指的是加密和解密时使用同一密钥的方式。又称为公共密钥密码 (common-key crypotography)、传统密码（conventional cryptography）、私钥密钥（secret cryptography）、共享密钥密码（shared-key cryptography）。
- **公钥密钥** （public-key scypotography） 是指加密和解密时使用不同密钥的方式。又称为非对称密钥 (asymmetric cryptography)。

历史上有几种比较著名的密码：

- 凯撒密码。通过将明文中所用到的字母表按照一定的字数 “平移” 来进行加密。在日语（平假名）或者汉语（汉语拼音）也可以用同样的思路来实现凯撒密码。
- 简单密码替换。蒋明文中使用的字母表替换为另一套字母表的密码。凯撒密码也可以说是简单替换密码的一种。
- Enigma。二次大战中俄国使用的一种密码机。是一种由键盘、齿轮、电池和灯泡所组成的机器。

对应的破译方法为：

- 暴力攻击
- 频率分析

## 对称密钥

主要包括：

- 一次性密码本，也称为维纳密码（Vernam Cipher）。将明文和遗传随机的比特序列进行 XOR 运算，是绝对不会被破译的密码。这里说的无法破译，即便能够解出明文，也无法判断它是否是正确的明文。在一次性密码中是绝对不能重用过去用过的随机比特序列的。
- DES。1977 年美国联邦信息处理标准（FIPS）中所采用的一种对称密码。DES 已经能够被暴力破解。由于 DES 的密文可以在短时间内被破译，因此除了用它来破解以前的密文之外，不应该再使用 DES 了。
- 三重 DES
- AES

### DES

DES/3DES 是以 64 字节的明文（比特序列）为一个单位来进行加密的，这个 64 比特的单位称为**分组**。一个分组的比特数称为**分组长度**
。

当最后一个明文分组的内容小于分组长度时，需要用一些特定的数据进行**填充**（padding）。

DES/3DES 的密钥长度是 64 比特，但由于每隔 7 比特会设置一个用于错误检查的比特，因此实际上其密钥长度是 56 比特。

一般来说，以分组为单位进行处理的密码算法称为**分组密码**（block cipher）。DES 和 3DES 均属于分组密码。

**流密码**（stream cipher）是对数据流进行连续处理的一类密码算法。流密码中一般以 1 比特、8 比特或者 32 比特等为单位进行加密和解密。

分组密码处理完一个分组就结束了，因此不需要通过内部状态来记录加密的进度，相对的，流密码是对遗传数据流进行连续处理，因此需要保持内部状态。

DES 每次只能加密 64 比特的数据，如果要加密的明文比较长，就需要对 DES 加密进行迭代（反复），而迭代的具体方式就称为**模式** （mode）。

DES 的基本结构是由 Horst Feistel 设计的，称为 Feistel 网络（Feistal network）。具体参考 《图解密码技术》 Ch3.5。DES 是一种 16 轮循环的 Feistel 网格。在 Feistel 网络中，每一轮都需要使用一个不同的子密钥，这些子密钥由主要生成。

### 三重 DES

三重 DES(triple-des) 是为了增加 DES 的强度，将 DES 重复 3 次所得到的一种密码算法，缩写为 3DES。

3DES 算法并不是进行 3 次 DES 加密（加密->加密->加密），而是加密->解密->加密，目的是让 3DES 能够兼容普通的 DES。当 3DES 中多有的密钥都相同时，3 DES 也就等同于普通的 DES 了，这是因为前两部加密->解密之后，得到的就是最初的明文。

如果秘钥 1 和秘钥 3 使用相同的秘钥，而秘钥 2 使用不同的秘钥，这种 3DES 称为 DES-EDE2，EDE表示的是加密->解密->加密（Encryption->Decryption->Encryption）。

具体加解密过程 具体参考 《图解密码技术》 Ch3.6。

尽管 3DES 目前还被银行等机构使用，但其处理速度不高，二球在安全性方面也逐渐显现出一些问题。

### AES

AES(Advance Encryption Standard)是取代其前任标准（DES）而称为新标准的一种对称密码算法。全世界企业和密码学家提交了多个对称秘钥算法微微 AES 候选，最终在 2000 年中这些候选算法中选出了一种名为 Rijndaeal 对对称密码算法，并将其确认为 AES。

Rjindael 的分组长度为 128 比特，16 字节，秘钥长度可以以 32 比特，在 128 比特到 256 比特的范围内选择。不过，在 AES 的规格中，密码程度只有 128、192、256 三种。

Rjindael 算法也是有多个轮所构成，使用的是 SPN 结构。

今后大家都应该使用的算法是 AES，因为它安全、快速，而且能够在各种平台上工作。

### 密码分组模式

分组密码的主要模式有以下 5 中：

- ECB 模式： Electronic Codebook mode(电子密码本模式)。将明文分组加密之后的结果将直接成为密文分组。

  ECB 模式是所有模式中最简单的一种。明文分组和密文分组是一一对应的关系。因此，ECB 模式存在一定的风险。

  攻击者无须破译密码就能够操纵电文，只需要知道哪个分组记录了什么样的数据（即电文格式）就可以了。

- CBC 模式：Cipher Block Chaining mode(密码分组链接模式)。首先将明文分组与前一个分组进行 XOR 运算，然后再进行加密。

  和第一个分组进行 XOR 运算的 “密文分组”称为**初始化向量**（initialization vector），通常缩写为 IV。一般来说，每次加密时都会随机产生一个不同的布特序列作为初始化向量。

  在 CBC 模式中，无法单独对一个中间的明文进行加密。

  对 CBC 的攻击为对初始化向量的比特反转。

- CFB 模式：Cipher Feedback mode（密文反馈模式）。明文分组和前一个密文分组加密后的结果做 XOR 运算得到密文分组。也就是说前一个密文分组会被送回到密码算法的输入端。

  明文分组并没有通过密码算法来直接加密，而只有一个 XOR 运算。

  对 CFB 的攻击为重放攻击。

- OFB 模式：Output FeedBack mode（输出反馈模式）。通过明文分组和 “密码算法的输出”进行 XOR 运算来产生密钥分组。即密钥算法的输出会反馈到密钥算法的输入。第一个明文文组的 XOR 对象为初始化向量的加密密文，对这个加密密文的再加密的密文为第二个明文分组的 XOR 对象，以此类推。

  OFB 模式也为流密码。

- CTR 模式：CounTex mode（计算器模式）。通过将逐次累加的计数器进行加密来生成密钥流的流密码。

模式  | 优点  | 缺点  |  备注
--|---|---|--
ECB  | <li>简单<li>快速<li>支持并行计算  | <li>不能抵御重放攻击  | 不应使用
CBC  | <li>支持并行计算<li>能够解密任意密文分组  | <li>不支持并行计算  |推荐使用
CFB  |<li>不需要填充<li>支持并行计算（仅解密）<li>能够解密任意密文分组   | <li>加密不支持并行计算<li>不能抵御重放攻击  | 现在已不适用，推荐用 CTR 模式替代。
OFB  |<li>不需要填充  | <li>不支持并行计算<li>反转攻击  | 推荐用 CTR 代替
CTR  |<li>不需要填充<li>支持并行计算  |  | 推荐使用


## 非对称密钥

## 混合密码系统

## Books

- [crypto101/book: Crypto 101, the introductory book on cryptography.](https://github.com/crypto101/book)
- 《图解密码技术》 [日]结城浩 著 周自恒 译
