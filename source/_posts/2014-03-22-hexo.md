---
layout: post
title: "使用 Hexo 搭建静态博客"
categories: Blog
tags: [blog,hexo]
---
## 安装

Installing Hexo is quite easy. However, there're something required before you get started.

* [Node.js](http://nodejs.org/)
* [Git](http://git-scm.com/)

__Install Hexo：__

    $ npm install -g hexo

参考：[Documentation | Hexo](http://zespia.tw/hexo/docs/)

__生成脚手架：__

    $ hexo init <folder>

生成的文件结构为：

    .
    ├── _config.yml 配置文件
    ├── package.json 
    ├── scaffolds 生成文章的layout脚手架
    ├── scripts 脚本文件
    ├── source 文章目录
    |   ├── _drafts
    |   └── _posts
    └── themes 主题

<!--more-->

__配置：__

请参考：[Configuration | Hexo](http://zespia.tw/hexo/docs/configuration.html)

配置文件为：_config.yaml

其中比较重要的有

* title, subtitle 这类基本信息
* language 可以用zh-CN，这在后面的theme配置当中有作用
* url, root 填以后要布的域名和路径
* plugins 我加了一个hexo-generator-feed，通过npm install hexo-generator-feed --save安装，这样在生成的时候会自动生成atom.xml，用来提供别人订阅

修改_config.yaml的话有时候是需要重新启动hexo server才能看到效果的。

参考：[使用hexo搭建静态博客 | Jim Liu's Blog](http://jimliu.net/2013/09/08/%E4%BD%BF%E7%94%A8hexo%E6%90%AD%E5%BB%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/)

## Usage

以下中括号内容为对应命令的Alias。更详细的使用请参考[Commands | Hexo](http://zespia.tw/hexo/docs/commands.html)

### 启动服务 server[s]

通过该命令启动服务后，服务会监听文件的变化，但不会更新public/文件夹，如果要生成静态文件到public/下，请使用generate命令。

    // -p 端口号， -d Serve drafts as normal posts。
    // 你也可以在_config.yml中修改端口号，默认为4000。
    // 如果要以调试模式启动，请使用--debug参数。
    $ hexo server [-p 4000] [-d]

### 部署博客 deploy[d]

参考：[Deployment | Hexo](http://zespia.tw/hexo/docs/deployment.html)

Hexo可以将生成的public/中的内容发布到各开源社区，如Github、 Heroku等，我们以Github为例。

__修改 `_config.yml`：__

    deploy:
      type: github
      repository: GitHub repository URL (Better to use HTTPS)
      branch: The brach to deploy to. Default is gh-pages.

branch参数相当重要，可是在官网文档并未提到。

__发布：__

    $ hexo deploy

注意：该命令并不重新生成博客，如果要生成，请使用参数`--generate`

    // 该命令和 hexo generate --deploy 等效
    $ hexo deploy --generate

__Custom Domain:__

Create a file named CNAME in source folder with the following content.

    example.com  

* **Top-level Domain:** Add A record 204.232.175.78
* **Subdomain**: Add CNAME record blog.example.com.

Check [GitHub Pages](https://help.github.com/articles/setting-up-a-custom-domain-with-pages) for more info.

### 新建文章 new[n]

参考：[Writing | Hexo](http://zespia.tw/hexo/docs/writing.html)

    $ hexo new [layout] <title>

Creates a new article. If layout isn't defined, it'll be default_layout setting. If the title is more than one word, wrap it with quotation marks.

Hexo has 3 default layouts: post, page and draft.

Layout|  Destination
------|-------------
post (Default)|  source/_posts
page|    source
draft|   source/_drafts

我们常用的为以下两个指令：

    hexo new "Hello World"
    hexo new draft "Hello World"

我们把写在`---`前的东东称为Front-matter，常用的配置项有：

Setting| Description| Default
-------|-------------|--------
layout | Layout|  post/page
title  | Title | 
date   | Published date |  File created date
updated| Last updated date |  File last updated date
tags   | Tags (Not available for pages)|  
categories|  Categories (Not available for pages)

可以为一篇文章同时指定多个目录，后面为前者的子目录，如：

    categories: 
    - foo
    - bar
    ---

或者：

    categories: [foo, bar]
    ---

其他配置请参考 [Writing | Hexo](http://zespia.tw/hexo/docs/writing.html#front-matter)

### 生成静态文件 generate[g]

根据Markdown文件将对应的HTML静态文件生成到public/文件夹中。

    $ hexo generate

__参数：__

Option | Description
-------|-------------
-d(--deploy) | Deploy after generate done 
-w(--watch) | Watch file changes 

我们可以使用以下批处理文件：
    
    // 生成静态文件并发布到，且实时监控文件的变化。
    $ hexo generate -d -w

### 发布草稿 public[p]

    $ hexo publish <filename>

### 移植 migrate

参考：[Migration | Hexo](http://zespia.tw/hexo/docs/migration.html)

由于我需要从Jekyll移植过来，所以只关心Jekyll的移植，其他类型的移植请参考 [Migration | Hexo](http://zespia.tw/hexo/docs/migration.html)。

Jekyll的移植相当简单，因为Jekyll的文件名都是类似这样的形式`2013-07-16-extjs-chart.md`，所以你需要：

-  把md文件拷贝到source/_posts/下面
- 修改`_config.yml`文件的new_post_name：`new_post_name: :year-:month-:day-:title.md`。
- 删除文章中 `{{ "{% include JB/setup" }}%}`。
- 将category:改为categories: [可选]

Jekyll的移植用不上migrate指令，wordpress的移植需要用上。

### Read More

You can hide parts of your post by adding `<!-- more -->` in the content. Index page will only show the post from the first to the first occurrence of `<!-- more -->`.

### 代码高亮 Highlight

官网提供 **Backtick code block** and **Swig code block**两种高亮方式：

__Backtick Code Block__

    ``` [language] [title] [url] [link text]
    code snippet
    ```

__Swig Code Block__

    {{ "{% code [title] [lang:language] [url] [link text]" }} %}
    code snippet
    {{ "{% endcode" }} %}

TODO : [Generating | Hexo](http://zespia.tw/hexo/docs/generating.html)

其他：

- [Prism](http://prismjs.com/)

### 写作

- [Block Quote & Code Block](http://hexo.io/docs/tag-plugins.html)

### 主题 Theme

__安装主题：__

    $ git clone <repository> themes/<theme-name>

修改`_config.yml`中的`theme`为<theme-name>。

- 主题开发：[Themes | Hexo](http://zespia.tw/hexo/docs/themes.html)
- 主题列表：[Themes · tommy351/hexo Wiki](https://github.com/tommy351/hexo/wiki/Themes)

Hexo uses [EJS](https://github.com/visionmedia/ejs) to process theme layout by default. Hexo provides [EJS](https://github.com/visionmedia/ejs) and [Swig](http://paularmstrong.github.com/swig/) template engine.

在开发主题时，最好使用调试模式启动服务，在调试模式下，所有的layout和sources将自动更新。

    $ hexo server --debug

主题的文件结构为：

    .
    ├── _config.yml Theme configuration file.
    ├── languages Folder of language files.
    ├── layout Layout folder. File or folder whose name is prefixed with _ (underscore) and hidden files will be ignored.
    ├── scripts  JavaScript files in this folder will be loaded when Hexo started.
    └── source

每个主题可以包括以下layout，但至少要有`index` layout.

Layout  |Description |Fallback
--------|------------|--------
index   |Index layout|      
post    |Post layout |index
page    |Page layout |index
archive |Archives layout |index
category|    Category archives layout   | archive
tag     | Tag archives layout| archive

个人比较喜欢的主题：

- [hexojs/hexo-theme-light](https://github.com/hexojs/hexo-theme-light)
- [hexojs/hexo-theme-phase](https://github.com/hexojs/hexo-theme-phase)
- [raytaylorlin/hexo-theme-raytaylorism](https://github.com/raytaylorlin/hexo-theme-raytaylorism) 特效
- [battlemidget/hexo-theme-striped](https://github.com/battlemidget/hexo-theme-striped) 支持多设备
- [kywk/hexo-theme-awe](https://github.com/kywk/hexo-theme-awe) 可借鉴 sitemap设计。
- [daisygao/hexo-themes-cover](https://github.com/daisygao/hexo-themes-cover)

### 编程 Coding

- [Variables | Hexo](http://zespia.tw/hexo/docs/variables.html)
- [Models | Hexo](http://zespia.tw/hexo/docs/models.html)
- [Events | Hexo](http://zespia.tw/hexo/docs/events.html)
- [Plugins | Hexo](http://zespia.tw/hexo/docs/plugins.html)

### 分页 Pagination

Hexo 默认支持分页，默认的页大小为10，可以在`_config.yml`中修改`per_page`。

显示前一页和后一页的代码如下（在文章中使用）：

    <% if (page.prev){ %>
      <a href="<%- config.root %><%- page.prev_link %>">Prev</a>
    <% } %>
    <% if (page.next){ %>
      <a href="<%- config.root %><%- page.next_link %>">Next</a>
    <% } %>

To display pagination in number. You can use paginator helper. It helps you insert pagination fast. （在主页中使用）

    <%- paginator() %>

### Comment

可参考主题：[heroicyang/hexo-theme-modernist](https://github.com/heroicyang/hexo-theme-modernist)

对于文章中的以下特殊字符需要加注释处理，否则会造成编译失败：

- {%raw%}{{ }}{%raw%}
- - {%raw%}| someword {%raw%}

### Plugins

- [Plugins · tommy351/hexo Wiki](https://github.com/tommy351/hexo/wiki/Plugins)

### 工具函数 Helper

[Helpers | Hexo](http://zespia.tw/hexo/docs/helpers.html)

### 注释 Comment

当你需要在文章中插入如 {% raw %} {% %} {% endraw %}的字符时，请参考：[Make swig optional for certain files? · Issue #30 · tommy351/hexo](https://github.com/tommy351/hexo/issues/30)

### GitHub

- [lepture/github-cards](https://github.com/lepture/github-cards) The unofficial GitHub Cards. Card for your GitHub profile, card for your GitHub repositories. <http://lab.lepture.com/github-cards/>

## 文档

- [tommy351/hexo](https://github.com/tommy351/hexo)
- [hexo你的博客 - 推酷](http://www.tuicool.com/articles/AfQnQjy)
- [Hexo - Node.js blog framework](http://zespia.tw/hexo/)
- [Documentation | Hexo](http://zespia.tw/hexo/docs/)

## Theme

- [xiangming/hexo](https://github.com/xiangming/hexo)  针对大陆地区对landscape主题进行优化 [http://reqianduan.com](http://reqianduan.com/)

## Plugins

- [Hexo UML插件](http://catx.me/2014/03/12/hexo-uml-tag-plugin/)



## 教程

- [使用hexo搭建静态博客 | Jim Liu's Blog](http://jimliu.net/2013/09/08/%E4%BD%BF%E7%94%A8hexo%E6%90%AD%E5%BB%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/)
- [hexo | Zippera's blog](http://zipperary.com/categories/hexo/)
- [将博客从jekyll迁移到了hexo - StanZhai - 博客园](http://www.cnblogs.com/jasondan/p/3499227.html)
- [使用hexo搭建博客 | Alimon's Blog](http://yangjian.me/workspace/building-blog-with-hexo/)