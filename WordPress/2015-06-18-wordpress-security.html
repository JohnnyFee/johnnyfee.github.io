<!DOCTYPE html>
<html>
<head>
    
<!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-43567748-2', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<!-- End Google Analytics -->


    

    



    <meta charset="utf-8">
    
    <meta name="google-site-verification" content="true">
    
    
    
    <title>WordPress Security | Balance | 大道至简</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="tutorial,wordpress">
    <meta name="description" content="Security BasicsThese are the simplest but most important security tips to consider. Pay attention here because it could save you a lot of time, money, and upset visitors/members.
Update FrequentlyThe">
<meta property="og:type" content="article">
<meta property="og:title" content="WordPress Security">
<meta property="og:url" content="http://blog.inching.org/WordPress/2015-06-18-wordpress-security.html">
<meta property="og:site_name" content="Balance">
<meta property="og:description" content="Security BasicsThese are the simplest but most important security tips to consider. Pay attention here because it could save you a lot of time, money, and upset visitors/members.
Update FrequentlyThe">
<meta property="og:updated_time" content="2017-11-22T08:34:46.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="WordPress Security">
<meta name="twitter:description" content="Security BasicsThese are the simplest but most important security tips to consider. Pay attention here because it could save you a lot of time, money, and upset visitors/members.
Update FrequentlyThe">
    
        <link rel="alternate" type="application/atom+xml" title="Balance" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/style/style.css?v=1.6.17">

    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-2846834382442028",
        enable_page_level_ads: true
      });
    </script>

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.png">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Cody Fei</h5>
          <a href="mailto:inchingcode@gmail.com" title="inchingcode@gmail.com" class="mail">inchingcode@gmail.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                Home
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags/android"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/Android/"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/inchingorg" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://www.weibo.com/CodyFee" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.inesoi.com" target="_blank" >
                <i class="icon icon-lg icon-shopping-bag"></i>
                Shopping Bag
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">WordPress Security</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">WordPress Security</h1>
        <h5 class="subtitle">
            
                <time datetime="2015-06-17T16:00:00.000Z" itemprop="datePublished" class="page-time">
  2015-06-18
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/WordPress/">WordPress</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Security-Basics"><span class="post-toc-text">Security Basics</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Update-Frequently"><span class="post-toc-text">Update Frequently</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Don’t-Use-the-Username-“admin”"><span class="post-toc-text">Don’t Use the Username “admin”</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Use-a-Strong-Password"><span class="post-toc-text">Use a Strong Password</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Examples-of-Bad-Passwords"><span class="post-toc-text">Examples of Bad Passwords</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Examples-of-Good-Passwords"><span class="post-toc-text">Examples of Good Passwords</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Hardening-Your-WordPress-Install"><span class="post-toc-text">Hardening Your WordPress Install</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Don’t-Allow-Admins-to-Edit-Plugins-or-Themes"><span class="post-toc-text">Don’t Allow Admins to Edit Plugins or Themes</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Change-Default-Database-Tables-Prefix"><span class="post-toc-text">Change Default Database Tables Prefix</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Move-wp-config-php"><span class="post-toc-text">Move wp-config.php</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Hide-Login-Error-Messages"><span class="post-toc-text">Hide Login Error Messages</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Hide-Your-WordPress-Version"><span class="post-toc-text">Hide Your WordPress Version</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Don’t-Allow-Logins-via-wp-login-php"><span class="post-toc-text">Don’t Allow Logins via wp-login.php</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Add-Custom-htaccess-Rules-for-Locking-Down-wp-admin"><span class="post-toc-text">Add Custom .htaccess Rules for Locking Down wp-admin</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Backup-Everything"><span class="post-toc-text">Backup Everything!</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Scan-Scan-Scan"><span class="post-toc-text">Scan Scan Scan!</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Useful-Security-Plugins"><span class="post-toc-text">Useful Security Plugins</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Spam-Blocking-Plugins"><span class="post-toc-text">Spam-Blocking Plugins</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Akismet"><span class="post-toc-text">Akismet</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Bad-Behavior"><span class="post-toc-text">Bad Behavior</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Backup-Plugins"><span class="post-toc-text">Backup Plugins</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Backup-Buddy"><span class="post-toc-text">Backup Buddy</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#VaultPress"><span class="post-toc-text">VaultPress</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Scanner-Plugins"><span class="post-toc-text">Scanner Plugins</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#WP-Security-Scan"><span class="post-toc-text">WP Security Scan</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Exploit-Scanner"><span class="post-toc-text">Exploit Scanner</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#BBQ"><span class="post-toc-text">BBQ</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Antivirus-Once"><span class="post-toc-text">Antivirus-Once</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Login-and-Password-Protection-Plugins"><span class="post-toc-text">Login and Password-Protection Plugins</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Limit-Login-Attempts"><span class="post-toc-text">Limit Login Attempts</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Ask-Apache-Password-Protect"><span class="post-toc-text">Ask Apache Password Protect</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Writing-Secure-Code"><span class="post-toc-text">Writing Secure Code</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Check-User-Capabilities"><span class="post-toc-text">Check User Capabilities</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#user-can-user-capability"><span class="post-toc-text">user_can( $user, $capability )</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#current-user-can-capability"><span class="post-toc-text">current_user_can( $capability )</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#current-user-can-for-blog-blog-id-capability"><span class="post-toc-text">current_user_can_for_blog( $blog_id, $capability )</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Custom-SQL-Statements"><span class="post-toc-text">Custom SQL Statements</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Data-Validation-Sanitization-and-Escaping"><span class="post-toc-text">Data Validation, Sanitization, and Escaping</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#esc-url-url-protocols-null-context-display"><span class="post-toc-text">esc_url( $url, $protocols = null, $_context = display )</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#esc-url-raw-url-protocols-null"><span class="post-toc-text">esc_url_raw( $url, $protocols = null )</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#esc-html-text"><span class="post-toc-text">esc_html( $text )</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#esc-js-text"><span class="post-toc-text">esc_js( $text )</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#esc-attr-text"><span class="post-toc-text">esc_attr( $text )</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#esc-textarea-text"><span class="post-toc-text">esc_textarea( $text )</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#sanitize-option-option-value"><span class="post-toc-text">sanitize_option( $option, $value )</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#sanitize-text-field-str"><span class="post-toc-text">sanitize_text_field($str)</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#sanitize-user-username-strict-false"><span class="post-toc-text">sanitize_user( $username, $strict = false )</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#sanitize-title-title-fallback-title-‘’"><span class="post-toc-text">sanitize_title( $title, $fallback_title = ‘’ )</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#sanitize-email-email"><span class="post-toc-text">sanitize_email( $email )</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#sanitize-file-name-filename"><span class="post-toc-text">sanitize_file_name( $filename )</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#wp-kses-string-allowed-html-allowed-protocols-array"><span class="post-toc-text">wp_kses( $string, $allowed_html, $allowed_protocols = array () )</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Nonces"><span class="post-toc-text">Nonces</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#wp-create-nonce-action-1"><span class="post-toc-text">wp_create_nonce( $action = -1 )</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#wp-verify-nonce-nonce-action-1"><span class="post-toc-text">wp_verify_nonce($nonce, $action = -1)</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#check-admin-referer-action-1-queryarg-wpnonce"><span class="post-toc-text">check_admin_referer($action = -1, $queryarg = __wpnonce)</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#wp-nonce-url-actionurl-action-1"><span class="post-toc-text">wp_nonce_url( $actionurl, $action = -1 )</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#wp-nonce-field-action-1-name-“-wpnonce”-referer-true-echo-true"><span class="post-toc-text">wp_nonce_field( $action = -1, $name = “_wpnonce”, $referer = true , $echo = true )</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#check-ajax-referer-action-1-query-arg-false-die-true"><span class="post-toc-text">check_ajax_referer( $action = -1, $query_arg = false, $die = true )</span></a></li></ol></li></ol></li></ol>
        </nav>
    </aside>
    
<article id="post-wordpress-security"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">WordPress Security</h1>
        <div class="post-meta">
            <time class="post-time" title="2015-06-18 00:00:00" datetime="2015-06-17T16:00:00.000Z"  itemprop="datePublished">2015-06-18</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/WordPress/">WordPress</a></li></ul>



            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h2 id="Security-Basics"><a href="#Security-Basics" class="headerlink" title="Security Basics"></a>Security Basics</h2><p>These are the simplest but most important security tips to consider. Pay attention here because it could save you a lot of time, money, and upset visitors/members.</p>
<h3 id="Update-Frequently"><a href="#Update-Frequently" class="headerlink" title="Update Frequently"></a>Update Frequently</h3><p>The first and most important security tip is to always make sure you upgrade to the most recent version of WordPress as soon as a new version becomes available and also always update any plugins/themes that you have installed on your site. Many of the updates that are pushed out involve security updates; therefore, it is always important to upgrade your software in order to stay up to date and safe.</p>
<a id="more"></a>
<h3 id="Don’t-Use-the-Username-“admin”"><a href="#Don’t-Use-the-Username-“admin”" class="headerlink" title="Don’t Use the Username “admin”"></a>Don’t Use the Username “admin”</h3><p>Another important item to take care of is making sure not to use “admin” as one of your user accounts. Many bots will automatically try to login to your site with the username “admin.” Knowing that most people don’t change this account is half the battle; all they really need to focus on is guessing the password. When installing WordPress, the default username will be “admin” unless you specifically change it, and you SHOULD specifically change it! If you are already using WordPress and are using the username “admin,” you should create a new user account with an administrator role, login with that new user, and delete the default admin account. <em>Make sure to change any posts or pages created by your admin account to this new account.</em></p>
<h3 id="Use-a-Strong-Password"><a href="#Use-a-Strong-Password" class="headerlink" title="Use a Strong Password"></a>Use a Strong Password</h3><p>Choosing a secure password is also very important, especially for your administrator accounts. Don’t use one word or one name. Jumble your password up and make it not connected to you personally.</p>
<p>Make sure your password is a combination of upper- and lowercase letters as well as numbers and special characters. A good password should also be at least 10 characters long; the more characters you use, the stronger your password will be. If you are having trouble coming up with one yourself, just mash on your keyboard a bit or use a service like <a href="http://www.random.org/passwords/" target="_blank" rel="external">Random.org</a>. Make sure you memorize it or copy it somewhere and secure it properly. WordPress will tell you if you are using a strong password; please take this into consideration.</p>
<h3 id="Examples-of-Bad-Passwords"><a href="#Examples-of-Bad-Passwords" class="headerlink" title="Examples of Bad Passwords"></a>Examples of Bad Passwords</h3><ul>
<li>password</li>
<li>password123</li>
<li>pa55w0rd</li>
<li>123456789</li>
<li>qwerty</li>
<li>batman</li>
<li>mustang</li>
<li>letmein</li>
</ul>
<p>Using any variation of password or single words, numbers, or names is a bad idea:</p>
<ul>
<li>usmarine (I was in the Marines)</li>
<li>brianmessenlehner (my first and last name)</li>
<li>brian&amp;robin91011 (my name, my wife’s name, and our anniversary)</li>
<li>Dalya-Brian (my daughter’s name and my son’s name)</li>
<li>ThaiShortiMaxx (my pets)</li>
<li>IAMAWESOME! (everybody knows this, so it could be easy to guess)</li>
</ul>
<p>Anybody that knows anything about me and my family could potentially guess passwords like these.</p>
<h3 id="Examples-of-Good-Passwords"><a href="#Examples-of-Good-Passwords" class="headerlink" title="Examples of Good Passwords"></a>Examples of Good Passwords</h3><ul>
<li>U$s(#8H27@!</li>
<li>!lik32EaTF1$h&amp;CHIp5</li>
<li>#Uk@nN0tBr3akTh1s$h1t!!!</li>
<li><em>[0mG-LoL-R0Fl-T0T3$CraY]</em>!</li>
</ul>
<p>It can be a pain in the neck and take an extra second or two entering in a good password but it’s well worth it if it can prevent your website/application from getting hacked.</p>
<h2 id="Hardening-Your-WordPress-Install"><a href="#Hardening-Your-WordPress-Install" class="headerlink" title="Hardening Your WordPress Install"></a>Hardening Your WordPress Install</h2><p>Let’s go over a few techniques for making it harder for your application to hacked.</p>
<h3 id="Don’t-Allow-Admins-to-Edit-Plugins-or-Themes"><a href="#Don’t-Allow-Admins-to-Edit-Plugins-or-Themes" class="headerlink" title="Don’t Allow Admins to Edit Plugins or Themes"></a>Don’t Allow Admins to Edit Plugins or Themes</h3><p>By default, WordPress allows administrators to edit the source code of any plugin or theme directly in the web browser. You should disable this functionality so just in case a hacker is able to login to one of your admin accounts, he can’t add any malicious code via the admin user interface for editing code. To disable this functionality, add this code to your <em>wp-config.php</em> file:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">define( &apos;DISALLOW_FILE_EDIT&apos;, true );</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<h3 id="Change-Default-Database-Tables-Prefix"><a href="#Change-Default-Database-Tables-Prefix" class="headerlink" title="Change Default Database Tables Prefix"></a>Change Default Database Tables Prefix</h3><p>The standard WordPress install uses <code>wp_</code> as a prefix for all tables in the database. By simply changing this prefix to something else, you will make your site a lot less vulnerable to hackers who attempt SQL injections and assume that you are using the generic <code>wp_</code> prefix. On a brand new WordPress install, you will have the option to use any table prefix you want; you should change the default <code>wp_</code> prefix to something custom.</p>
<p>If you would like to do this on a WordPress site that is already up and running, you can follow these steps:</p>
<ol>
<li>Make a database backup just in case you mess this up!</li>
<li><p>Open <em>wp-config.php</em> and change</p>
<p><code>$table_prefix = &#39;wp_&#39;;</code></p>
<p>to</p>
<p><code>$table_prefix = &#39;anyprefix_&#39;;</code></p>
</li>
<li><p>Update the existing table names in your database to include your new prefix with the following SQL commands using phpMyAdmin or any SQL client such as MySQL Workbench:</p>
<pre><code>rename table wp_commentmeta to anyprefix_commentmeta;
rename table wp_comments to anyprefix_comments;
rename table wp_links to anyprefix_links;
rename table wp_options to anyprefix_options;
rename table wp_postmeta to anyprefix_postmeta;
rename table wp_posts to anyprefix_posts;
rename table wp_terms to anyprefix_terms;
rename table wp_term_relationships to anyprefix_term_relationships;
rename table wp_term_taxonomy to anyprefix_term_taxonomy;
rename table wp_usermeta to anyprefix_usermeta;
rename table wp_users to anyprefix_users;
</code></pre></li>
</ol>
<pre><code>You will have to run a similar rename SQL query for any custom tables added by your app or plugins you are using.
</code></pre><p>Using SQL commands or a SQL client update any instance of <code>wp_</code> in the <code>prefix_options</code> and <code>anyprefix_usermeta</code> tables and change any values like <code>wp_</code> to <code>prefix_</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">update anyprefix_options set option_name = replace(</div><div class="line">option_name,&apos;wp_&apos;,&apos;anyprefix_&apos;);</div><div class="line">update anyprefix_usermeta set meta_key = replace(</div><div class="line">meta_key,&apos;wp_&apos;,&apos;anyprefix_&apos;);</div></pre></td></tr></table></figure>
<p>Test out your site and make sure everything is working as it should.</p>
<p>If you don’t feel comfortable manually making these changes, there are some plugins that can change your table prefix for you:</p>
<ul>
<li><a href="http://bit.ly/change-tp" target="_blank" rel="external">Change Table Prefix</a></li>
<li><a href="http://bit.ly/change-db" target="_blank" rel="external">Change DB Prefix</a></li>
</ul>
<h3 id="Move-wp-config-php"><a href="#Move-wp-config-php" class="headerlink" title="Move wp-config.php"></a>Move wp-config.php</h3><p>The WordPress <em>wp-config.php</em> file stores valuable information like your database location, username, and password and your WordPress authentication keys. Since these values are stored in PHP variables and they are not displayed to the browser, it is not likely that anybody could gain access to this data, but it could happen. You can move <em>wp-config.php</em> to one level above your WordPress install, which in most cases should be a nonpublic directory. WordPress will automatically look one level up for <em>wp-config.php</em> if it doesn’t find it in your root directory. For example, move _/username/public<em>html/wp-config.php</em> to <em>/username/wp-config.php</em>.</p>
<p>You can also store <em>wp-config.php</em> as any filename in any directory location. To do this, make a copy of <em>wp-config.php</em>, name the copy whatever you want, and move it to any directory above your root install of WordPress. In your original <em>wp-config.php</em> file, remove all of the code and add an include to the relative path and filename of the copy you made. For example, copy _/username/public<em>html/wp-config.php</em> to <em>/username/someotherfolder/stuff.php</em>. Change the code in <em>wp-config.php</em> to <code>include(‘/username/someotherfolder/stuff.php’);</code></p>
<h3 id="Hide-Login-Error-Messages"><a href="#Hide-Login-Error-Messages" class="headerlink" title="Hide Login Error Messages"></a>Hide Login Error Messages</h3><p>Normally when trying to login in to your site, WordPress will display a message if you have put in the wrong username or password. Unfortunately this lets hackers know exactly what they are doing wrong or right when attempting to access your site.</p>
<p>Luckily there is a simple fix for this, which is to add a line of code into your theme <em>functions.php</em> file or in a custom plugin which will hide or alter those messages:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">add_filter( &apos;login_errors&apos;,</div><div class="line">create_function(</div><div class="line"> &apos;$a&apos;, &apos;&quot;Invalid username or</div><div class="line">password.&quot;;&apos;</div><div class="line">) );</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<h3 id="Hide-Your-WordPress-Version"><a href="#Hide-Your-WordPress-Version" class="headerlink" title="Hide Your WordPress Version"></a>Hide Your WordPress Version</h3><p>A lot of bots will scour the Internet in search of WordPress sites to target specifically by the version of WordPress they are running. They are looking for sites with known vulnerabilities they can exploit. By default, WordPress displays the following code within the <code>&lt;head&gt;&lt;/head&gt;</code> of every page:</p>
<pre><code>&lt;meta name=&quot;generator&quot; content=&quot;WordPress 3.8.1&quot; /&gt;
</code></pre><p>You can easily hide the version of WordPress you are using by implementing the following code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">add_filter( &apos;the_generator&apos;, &apos;__return_null&apos; );</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<h3 id="Don’t-Allow-Logins-via-wp-login-php"><a href="#Don’t-Allow-Logins-via-wp-login-php" class="headerlink" title="Don’t Allow Logins via wp-login.php"></a>Don’t Allow Logins via wp-login.php</h3><p>Some bots are smarter than others.`` We just talked about hiding your WordPress version from some bots, but sometimes just knowing that you are using WordPress is all a bot may be looking for, and this is pretty easy if it sends a POST request to <em>wp-login.php</em>. Once a bot realizes <em>wp-login.php</em> exists, it can then begin to try to login to your site.</p>
<p>We like to redirect <em>wp-login.php</em> to the homepage, which prevents bots from specifically trying to login via <em>wp-login.php</em>. Follow these steps to make an alternative login page and hide the default <em>wp-login.php</em> login page:</p>
<ol>
<li><p>Add the following rewrite rule to your <em>.htaccess</em> file:</p>
<p>RewriteRule ^new-login$ wp-login.php</p>
<p>Note that <code>new-login</code> will be the URL you can use to actually log in to <em>wp-admin</em>; you can change this to whatever you want.</p>
</li>
<li><p>In your theme <em>functions.php</em> file or in a custom plugin, add this code:</p>
<pre><code>&lt;?php
function schoolpress_wp_login_filter( $url, $path, $orig_scheme ) {
    $old = array( &quot;/(wp-login\.php)/&quot; );
    $new = array( &quot;new-login&quot; );
        return preg_replace( $old, $new, $url, 1 );
}
add_filter( &apos;site_url&apos;, &apos;schoolpress_wp_login_filter&apos;, 10, 3 );

function schoolpress_wp_login_redirect() {
        if ( strpos( $_SERVER[&quot;REQUEST_URI&quot;], &apos;new-login&apos; ) === false ) {
                wp_redirect( site_url() );
                exit();
        }
}
add_action( &apos;login_init&apos;, &apos;schoolpress_wp_login_redirect&apos; );
?&gt;
</code></pre><p>If you don’t want to write any custom code, you can use ``the following plugins to achieve similar results:</p>
</li>
</ol>
<ul>
<li><a href="http://bit.ly/ithemes-sec" target="_blank" rel="external">iThemes security</a></li>
<li><a href="http://bit.ly/lockdown-wp" target="_blank" rel="external">WP Admin</a></li>
</ul>
<h3 id="Add-Custom-htaccess-Rules-for-Locking-Down-wp-admin"><a href="#Add-Custom-htaccess-Rules-for-Locking-Down-wp-admin" class="headerlink" title="Add Custom .htaccess Rules for Locking Down wp-admin"></a>Add Custom .htaccess Rules for Locking Down wp-admin</h3><p>If you are the only user that needs to log in to the backend of your application, or if you only have a handful of backend users, you can restrict access to the backend by certain IP addresses. Create a new <em>.htaccess</em> file in the <em>wp-admin</em> directory of your WordPress install and add the following code, replacing <code>127.0.0.1</code> with your actual external IP address. Go to <em><a href="http://ipchicken.com/" target="_blank" rel="external">http://ipchicken.com/</a></em> if you are not sure of your external IP address:</p>
<pre><code>order deny,allow
allow from 127.0.0.1 #(repeat this line for multiple IP addresses)
deny from all
</code></pre><p>If you suspect that certain IP addresses hitting your application are bots or malicious users, you can block them by their IP addresses with the following code:</p>
<pre><code>order allow,deny
deny from 127.0.0.1 #(repeat this line for multiple IP addresses)
allow from all
</code></pre><p>If people really want to get around their banned IP address, they will use a proxy server.</p>
<p>If you think your IP address of you or your backend users may change often or you have way too many backend users to manage all of their IP addresses, you can add a separate username and password to access the <em>wp-admin</em> directory. This adds a nice second layer of authentication because all of your backend users will be required to enter an htaccess username and password and their standard WordPress username and password:</p>
<pre><code>AuthType Basic
AuthName &quot;restricted area&quot;
AuthUserFile /path/to/protected/dir/.htpasswd
require valid-user
</code></pre><p>Notice the <code>AuthUserFile</code> line; you will need to create a <em>.htpasswd</em> file somewhere in a directory above or outside of your WordPress install. In this file, you will need to add a username and password. The password can’t just be plain text; use a tool like <a href="https://www.vpnmentor.com/tools/secure-password-generator/" target="_blank" rel="external">Best Random Password Generator 2017</a> to create an encrypted password.</p>
<p>So the password for is like  <code>KxXpQNhgQ4</code></p>
<p>Add the entire encrypted string <code>letmein:E5Dj7cUaQVcN.</code> to your <em>.htpasswd</em> file; and when users try to go to <em>/wp-admin</em>, they will be prompted for a username and password. Make sure to let your backend users know what this username and password is and tell them not to share it with anybody.</p>
<h2 id="Backup-Everything"><a href="#Backup-Everything" class="headerlink" title="Backup Everything!"></a>Backup Everything!</h2><p>It is important to make regularly scheduled backups of your site’s content (your database) as well as the <em>wp-content</em> folder. This makes it much easier to restore your site in the event that it does fall victim to a hacker. We recommend scheduling a backup at the very least once a week; but depending upon how much new content you are adding, you may feel that you need to increase or decrease the frequency. Of course a daily backup is always the best choice.</p>
<h2 id="Scan-Scan-Scan"><a href="#Scan-Scan-Scan" class="headerlink" title="Scan Scan Scan!"></a>Scan Scan Scan!</h2><p>Scanning or monitoring your application is essential to know if you have been attacked. If your application ever gets hacked, it is important to know right away so you can immediately address the issue.</p>
<p>Be proactive about protecting your web application against malware. There are several services that will scan your web applications for you so you can take a more hands-off approach. We recommend using <a href="http://sucuri.net/" target="_blank" rel="external">Sucuri</a>. Not only will Sucuri find malware and alert you if your application has been infected, but it will also clean it up for you. Tony Perez, the COO of Sucuri, is also a former US Marine and a martial arts master, so why wouldn’t you want Sucuri to have your back? Sucuri also has a great <a href="http://bit.ly/sucuri-plugin" target="_blank" rel="external">security plugin</a> for WordPress.</p>
<h2 id="Useful-Security-Plugins"><a href="#Useful-Security-Plugins" class="headerlink" title="Useful Security Plugins"></a>Useful Security Plugins</h2><p>Below are some very useful and powerful WordPress plugins that will help you increase security for your application and also help you to recover quickly if you to fall victim to a malicious attack.</p>
<h3 id="Spam-Blocking-Plugins"><a href="#Spam-Blocking-Plugins" class="headerlink" title="Spam-Blocking Plugins"></a>Spam-Blocking Plugins</h3><h4 id="Akismet"><a href="#Akismet" class="headerlink" title="Akismet"></a>Akismet</h4><p>This plugin is used to block comment spam from getting through to your site. It was developed by Automattic, also the creators of WordPress, and therefore comes standard with any new WordPress install. Although the plugin will be installed on your site, you will need to activate it by registering for an API key at <a href="https://akismet.com/" target="_blank" rel="external">Akismit.com</a>. An API key is free if your site is for personal use; however, there is a small charge for business websites. The way Akismet works is each time a comment is posted to your site, Akismet will run it through a series of tests to ensure it is a real comment, and if it is identified as spam, it is automatically moved to the spam folder in your dashboard. This saves you tons of time from having to sort through all of your comments and determine which ones are spam or legitimate comments.</p>
<h4 id="Bad-Behavior"><a href="#Bad-Behavior" class="headerlink" title="Bad Behavior"></a>Bad Behavior</h4><p><a href="http://bit.ly/bad-behavior" target="_blank" rel="external">This plugin</a> works to block link spam from your site and functions best when run in conjunction with another spam service. It works to not only look at the content of the spam, but also looks at the method through which the spam is being delivered by the spammer and the software being used, and blocks that as well.</p>
<h3 id="Backup-Plugins"><a href="#Backup-Plugins" class="headerlink" title="Backup Plugins"></a>Backup Plugins</h3><p>Backups are very helpful to have in the event that your site is compromised. Here are a few popular backup plugins.</p>
<h4 id="Backup-Buddy"><a href="#Backup-Buddy" class="headerlink" title="Backup Buddy"></a>Backup Buddy</h4><p><a href="http://bit.ly/backup-b" target="_blank" rel="external">This plugin</a> works to make backups of all of the content on your WordPress site for safekeeping, restoring, or moving your site. Backups can be scheduled on a recurring basis and the file can then be downloaded to your computer, emailed to you, or sent off to the storage location of your choice such as Dropbox or an FTP server. This plugin also features a restore option that will easily restore your themes, widgets, and plugins. Backup Buddy also allows you to easily move your site to a new server or domain right from the WordPress dashboard, which comes in handy if you work on a dev server and then move the sites over to a production environment upon launch.</p>
<h4 id="VaultPress"><a href="#VaultPress" class="headerlink" title="VaultPress"></a>VaultPress</h4><p><a href="http://vaultpress.com/" target="_blank" rel="external">VaultPress</a> is another plugin created by the team at Automattic and offers users the opportunity to have all of their site content backed up in real time on cloud servers. Once installed, this plugin will automatically detect any changes to the content on your site as well as site settings and then update the backup copy with those changes. The plugin also features a one-click database restore in the event that your site ever becomes compromised. This is a premium plugin, meaning there is a fee for service, and different levels are offered. The premium version of the plugin also includes a daily security scan of your site to detect any issues as well as fixes for those issues.</p>
<h3 id="Scanner-Plugins"><a href="#Scanner-Plugins" class="headerlink" title="Scanner Plugins"></a>Scanner Plugins</h3><h4 id="WP-Security-Scan"><a href="#WP-Security-Scan" class="headerlink" title="WP Security Scan"></a>WP Security Scan</h4><p>This is a <a href="http://bit.ly/acunetix-wp" target="_blank" rel="external">free plugin</a> that will perform a scan of your site and detect any areas of vulnerability in your site’s security. It will then suggest fixes for any of the issues it finds. One of the important security issues this plugin helps with is changing your database table prefix, which can be tricky if you are not that familiar with the standard WordPress database structure. It also helps you to hide which version of WordPress you are using, which is information that hackers look for to use against you when attacking your site. This plugin was developed by WebsiteDefender.com, which also offers a <a href="http://bit.ly/acunetix-sec" target="_blank" rel="external">service to monitor your website for potential security threats, including malware and hacker activity</a>.</p>
<h4 id="Exploit-Scanner"><a href="#Exploit-Scanner" class="headerlink" title="Exploit Scanner"></a>Exploit Scanner</h4><p><a href="http://bit.ly/exploit-scan" target="_blank" rel="external">This plugin</a> will scan through all the files on your site and then alert you if it comes across anything that looks like it could be a potential threat.</p>
<h4 id="BBQ"><a href="#BBQ" class="headerlink" title="BBQ"></a>BBQ</h4><p><a href="http://bit.ly/bbq-wp" target="_blank" rel="external">Block Bad Queries</a> works as a type of firewall for your site by scanning all incoming traffic and then blocking all kinds of different malicious requests.</p>
<h4 id="Antivirus-Once"><a href="#Antivirus-Once" class="headerlink" title="Antivirus-Once"></a>Antivirus-Once</h4><p>Once <a href="http://bit.ly/antivirus-wp" target="_blank" rel="external">this plugin</a> is installed and activated, it will run a daily scan on your theme template files and database tables and alert you of any potential problems with email notifications. It will also add a message into the WordPress admin bar to alert you of any viruses.</p>
<h3 id="Login-and-Password-Protection-Plugins"><a href="#Login-and-Password-Protection-Plugins" class="headerlink" title="Login and Password-Protection Plugins"></a>Login and Password-Protection Plugins</h3><h4 id="Limit-Login-Attempts"><a href="#Limit-Login-Attempts" class="headerlink" title="Limit Login Attempts"></a>Limit Login Attempts</h4><p>This is a <a href="http://bit.ly/limit-login" target="_blank" rel="external">great plugin</a> to fight against brute-force attacks like someone running an automated script that will try to login to WordPress using random combinations of words. By default, WordPress will allow an unlimited amount of login attempts. This plugin limits the number of login attempts. If someone tries <em>x</em> times to log in and fails each time, she will be blocked from attempting to log in again for a set amount of time.</p>
<h4 id="Ask-Apache-Password-Protect"><a href="#Ask-Apache-Password-Protect" class="headerlink" title="Ask Apache Password Protect"></a>Ask Apache Password Protect</h4><p><a href="http://bit.ly/ask-apache" target="_blank" rel="external">This plugin</a> is different from other WordPress security plugins in that it works at the network level to prevent attacks rather than at the site level. You choose a unique username and password that then protect your login page and entire <em>wp-admin</em> folder. This plugin does require the use of an Apache web server and web host support for <em>.htaccess</em> files.</p>
<h2 id="Writing-Secure-Code"><a href="#Writing-Secure-Code" class="headerlink" title="Writing Secure Code"></a>Writing Secure Code</h2><p>You want to make sure any custom code you write is secure and isn’t hackable. If you take notice and apply the following methods, you should be in pretty good shape against attacks.</p>
<h3 id="Check-User-Capabilities"><a href="#Check-User-Capabilities" class="headerlink" title="Check User Capabilities"></a>Check User Capabilities</h3><p>Each of your users has unique standard or custom roles and capabilities. If you are writing some code that provides custom functionality for your application’s administrators, then make sure to give administrators and only administrators access to it. There are a few built-in WordPress functions for telling you if a user has certain roles or capabilities. All of these functions are located in <em>wp-includes/capabilities.php</em> and return a boolean of whether the user has the passed-in role name or capability. You can pass in any default or custom-made roles or capabilities.</p>
<h4 id="user-can-user-capability"><a href="#user-can-user-capability" class="headerlink" title="user_can( $user, $capability )"></a>user_can( $user, $capability )</h4><p>Whether a particular user has a particular role or capability.</p>
<ul>
<li>$user—A required integer of a user ID or an object of the user.</li>
<li>$capability—A required string of the capability or role name.</li>
</ul>
<h4 id="current-user-can-capability"><a href="#current-user-can-capability" class="headerlink" title="current_user_can( $capability )"></a>current_user_can( $capability )</h4><p>Whether the current user has a particular role or capability.</p>
<ul>
<li>$capability—A required string of the capability or role name.</li>
</ul>
<h4 id="current-user-can-for-blog-blog-id-capability"><a href="#current-user-can-for-blog-blog-id-capability" class="headerlink" title="current_user_can_for_blog( $blog_id, $capability )"></a>current_user_can_for_blog( $blog_id, $capability )</h4><p>Whether the current user has a particular role or capability for a particular site on a multisite network.</p>
<ul>
<li>$user—A required integer of a blog ID.</li>
<li>$capability—A required string of the capability or role name.</li>
</ul>
<p>In the following code, we don’t want to let ordinary users into the backend of our application. We want them to only interact with the custom UI we created within the theme on the frontend so we will redirect anybody that is not an administrator and may wander to <em>/wp-admin</em> back to the frontend:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">function schoolpress_admin_check() &#123;</div><div class="line">        global $user_ID;</div><div class="line">        if ( !user_can( $user_ID, &apos;administrator&apos; ) )</div><div class="line">                wp_redirect( site_url() );</div><div class="line">&#125;</div><div class="line">add_action( &apos;admin_init&apos;, &apos;schoolpress_admin_check&apos; );</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<h3 id="Custom-SQL-Statements"><a href="#Custom-SQL-Statements" class="headerlink" title="Custom SQL Statements"></a>Custom SQL Statements</h3><p>Sometimes the built-in WordPress functions that interact with the database may not be enough for your needs, and depending on what you are building, you may want to write custom SQL statements. When writing your own SQL statements, you need to make sure they are written in a way that will not allow for any potential SQL injections. First of all, always use the <code>$wpdb</code> object and make sure to escape and prepare all custom SQL statements.</p>
<p>As we talked about in <a href="ch03.html" title="Chapter 3. Leveraging WordPress Plugins">Chapter 3</a>, the <code>$wpdb</code> object can be used to access any standard or custom tables in your WordPress database and provides easy-to-use methods for doing so. One very important thing to remember is that when writing custom queries with any dynamic values being passed in, you need to use the <code>esc_sql()</code> function or the <code>prepare()</code> method to sanitize and escape those dynamic values. By sanitizing and escaping dynamic values, you are making sure those values are not made up of invalid characters and are not any malicious SQL code that can hijack your query (SQL injections).</p>
<p>The <code>esc_sql()</code> and <code>$wpdb-&gt;prepare()</code> functions are covered in detail in <a href="ch03.html" title="Chapter 3. Leveraging WordPress Plugins">Chapter 3</a>.</p>
<h3 id="Data-Validation-Sanitization-and-Escaping"><a href="#Data-Validation-Sanitization-and-Escaping" class="headerlink" title="Data Validation, Sanitization, and Escaping"></a>Data Validation, Sanitization, and Escaping</h3><p>DO NOT TRUST YOUR USERS! Again, DO NOT TRUST YOUR USERS! Don’t be that web application, website, or blog that spreads malware.</p>
<p>Validate, sanitize, and escape every piece of data going into and coming out of your database. You want to make sure that the data your users are submitting to your database is in the format it should be in; the database doesn’t care what the data is as long as the data being submitted is of the same datatype.</p>
<p>For example, let’s say you have a custom form used to collect user data with a textbox for date of birth. You plan on storing the DOB as user meta in the <code>meta_value</code> column of the <code>wp_usermeta</code> table. The <code>meta_value</code> column has a datatype of <code>longtext</code>, meaning the value can be super duper long<sup>[</sup>22] and the database isn’t going to care what value you store there. It’s up to you as the developer to make sure the data being stored as DOB is a date and nothing else.</p>
<p>So what exactly is the difference between validation, sanitization, and escaping?</p>
<ul>
<li><em>Validating</em> is the process of making sure the data received from the end user is in the correct format you expect it to be in. You want to validate data before saving it into the database.</li>
<li><em>Sanitizing</em> is the process of cleaning data received from the end user before saving it to the database.</li>
<li><em>Escaping</em> is the process of cleaning data you may already have before displaying it to the end user.</li>
</ul>
<p>Now you know!</p>
<p>You want to validate and sanitize data before putting it into your database. When pulling data out of your database, you want to sanitize it just to be safe in case somehow you are storing unsanitized data.</p>
<p>PHP has validation and sanitization functions, but WordPress has a bunch of helper functions built-in; and this is a book about WordPress, so let’s talk about some of those functions.</p>
<p>Most validation and sanitization helper functions are located in <em>wp-includes/formatting</em>.</p>
<h4 id="esc-url-url-protocols-null-context-display"><a href="#esc-url-url-protocols-null-context-display" class="headerlink" title="esc_url( $url, $protocols = null, $_context = display )"></a>esc_url( $url, $protocols = null, $_context = <em>display</em> )</h4><p>Checks and cleans a URL by checking if it has the proper protocol, stripping invalid characters and encoding special characters. Use this if displaying a URL to an end user:</p>
<ul>
<li>$url—A required string of the URL that needs to be cleaned.</li>
<li>$protocols—An optional array of whitelisted protocols. Defaults to <code>array( http, https, ftp, ftps, mailto, news, irc, gopher, nntp, feed, telnet, mms, rtsp, svn )</code> if not specifically set.</li>
<li>$context—An optional string of how the URL is being used. Defaults to <code>display</code>, which sends the URL through <code>wp_kses_normalize_entities()</code> and replaces <code>&amp;amp</code> with <code>&amp;#038;</code> and <code>‘</code> with <code>&amp;#039;</code>.</li>
</ul>
<h4 id="esc-url-raw-url-protocols-null"><a href="#esc-url-raw-url-protocols-null" class="headerlink" title="esc_url_raw( $url, $protocols = null )"></a>esc_url_raw( $url, $protocols = null )</h4><p>This function calls the <code>esc_url()</code> function but passes <code>db</code> as the value for the <code>$_context</code> parameter. Do not use this function for displaying URLs to the end user; only use it in database queries.</p>
<h4 id="esc-html-text"><a href="#esc-html-text" class="headerlink" title="esc_html( $text )"></a>esc_html( $text )</h4><p>Escape HTML blocks in any content. This function is a nice little wrapper for the <code>_wp_specialchars()</code> function which, basically converts a number of special characters into their HTML entities:</p>
<ul>
<li>$text—A required string of the text you want to escape HTML tags on.</li>
</ul>
<h4 id="esc-js-text"><a href="#esc-js-text" class="headerlink" title="esc_js( $text )"></a>esc_js( $text )</h4><p>Escapes strings in inline JavaScript. Escaped strings need to be wrapped in single quotes for this to work:</p>
<ul>
<li>$text—A required string of the text you want to escape single quotes, HTML special characters ( “ &lt; &gt; &amp; ), and fix line endings on.</li>
</ul>
<h4 id="esc-attr-text"><a href="#esc-attr-text" class="headerlink" title="esc_attr( $text )"></a>esc_attr( $text )</h4><p>Escapes HTML attributes and encodes such characters as &lt;, &gt;, &amp;,”, and ‘. This is important to use when including values in form input elements such as ID, name, alt, title, and value:</p>
<ul>
<li>$text—A required string of the text you want to escape HTML attributes on.</li>
</ul>
<h4 id="esc-textarea-text"><a href="#esc-textarea-text" class="headerlink" title="esc_textarea( $text )"></a>esc_textarea( $text )</h4><p>Escaping for <code>textarea</code> values. Encodes text for use inside a <code>&lt;textarea&gt;</code> element:</p>
<ul>
<li>$text—A required string of the text you want to escape HTML on.</li>
</ul>
<h4 id="sanitize-option-option-value"><a href="#sanitize-option-option-value" class="headerlink" title="sanitize_option( $option, $value )"></a>sanitize_option( $option, $value )</h4><p>This function can be used to sanitize the value of any predefined WordPress option. Depending on what option is being used, the value will be sanitized via various functions:</p>
<ul>
<li>$option—A required string of the name of the option.</li>
<li>$value—A required string of the unsanitized option value you wish to sanitize.</li>
</ul>
<h4 id="sanitize-text-field-str"><a href="#sanitize-text-field-str" class="headerlink" title="sanitize_text_field($str)"></a>sanitize_text_field($str)</h4><p>Sanitizes any string input by a user or pulled from the database. Checks for invalid UTF-8; converts single &lt; characters to entity; strips all tags; removes line breaks, tabs, and extra white space; and strips octets:</p>
<ul>
<li>$str—The required string you want to sanitize.</li>
</ul>
<h4 id="sanitize-user-username-strict-false"><a href="#sanitize-user-username-strict-false" class="headerlink" title="sanitize_user( $username, $strict = false )"></a>sanitize_user( $username, $strict = false )</h4><p>This function cleans a username of any illegal characters:</p>
<ul>
<li>$username—A required string of the username to be sanitized.</li>
<li>$strict—An optional boolean that if set to <code>true</code> will limit the username to specific characters.</li>
</ul>
<h4 id="sanitize-title-title-fallback-title-‘’"><a href="#sanitize-title-title-fallback-title-‘’" class="headerlink" title="sanitize_title( $title, $fallback_title = ‘’ )"></a>sanitize_title( $title, $fallback_title = ‘’ )</h4><p>Sanitizes a title stripping out any HTML or PHP tags, or returns a fallback title for a provided string:</p>
<ul>
<li>$title—A required string of the title to be sanitized.</li>
<li>$fallback_title—An optional string to use if the title is empty.</li>
</ul>
<h4 id="sanitize-email-email"><a href="#sanitize-email-email" class="headerlink" title="sanitize_email( $email )"></a>sanitize_email( $email )</h4><p>Sanitizes an email address by stripping out any characters not allowed in an email address:</p>
<ul>
<li>$email—The email address to be sanitized.</li>
</ul>
<h4 id="sanitize-file-name-filename"><a href="#sanitize-file-name-filename" class="headerlink" title="sanitize_file_name( $filename )"></a>sanitize_file_name( $filename )</h4><p>Sanitizes a filename, replacing whitespace with dashes. Removes special characters that are illegal in filenames on certain operating systems and special characters requiring special escaping to manipulate at the command line. Replaces spaces and consecutive dashes with a single dash. Trims period, dash, and underscore from beginning and end of filename:</p>
<ul>
<li>$filename—Required string of the file name to be sanitized.</li>
</ul>
<h4 id="wp-kses-string-allowed-html-allowed-protocols-array"><a href="#wp-kses-string-allowed-html-allowed-protocols-array" class="headerlink" title="wp_kses( $string, $allowed_html, $allowed_protocols = array () )"></a>wp_kses( $string, $allowed_html, $allowed_protocols = array () )</h4><p>This function makes sure that only the allowed HTML element names, attribute names, and attribute values plus only sane HTML entities will occur in the string you provide. You have to remove any slashes from PHP’s magic quotes before you call this function:</p>
<ul>
<li>$string—A required string that you want filtered through kses.</li>
<li>$allowed_html—A required array of allowed HTML elements.</li>
<li>$allowed_protocols—An optional array of allowed protocols in any URLs in the string being filtered. The default allowed protocols are <code>http</code>, <code>https</code>, <code>ftp</code>, <code>mailto</code>, <code>news</code>, <code>irc</code>, <code>gopher</code>, <code>nntp</code>, <code>feed</code>, <code>telnet</code>, <code>mms</code>, <code>rtsp</code>, and <code>svn</code>. This covers all common link protocols, except for <code>javascript</code>, which should not be allowed for untrusted users.</li>
</ul>
<p>The following code validates and sanitizes an email address:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">// let&apos;s pretend that a user added an email address &quot;brian @ webdevstudios.com&quot;</div><div class="line">$user_email = &apos;brian @ webdev$tudios.com&apos;;</div><div class="line"></div><div class="line">// we can check if this is a valid email</div><div class="line">$user_email = is_email( $user_email );</div><div class="line"></div><div class="line">// we know it&apos;s not because it&apos;s set to nothing from is_email()</div><div class="line">if ( ! $user_email )</div><div class="line">        echo &apos;invalid email&lt;br&gt;&apos;;</div><div class="line"></div><div class="line">// let&apos;s try again with sanitizing the email</div><div class="line">$user_email = &apos;brian @ webdev$tudios.com&apos;;</div><div class="line"></div><div class="line">// use sanitize_email() to try to fix any invalid email</div><div class="line">$user_email = sanitize_email( $user_email );</div><div class="line"></div><div class="line">$user_email = is_email( $user_email );</div><div class="line"></div><div class="line">if ( ! $user_email )</div><div class="line">        echo &apos;invalid email&lt;br&gt;&apos;;</div><div class="line">else</div><div class="line">        echo &apos;valid email: &apos; . $user_email;</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<h3 id="Nonces"><a href="#Nonces" class="headerlink" title="Nonces"></a>Nonces</h3><p>Nonce stands for “number used once,”`` and using nonces is critical to protecting your application from CSRF (cross-site request forgery) attacks.</p>
<p>Normally your server-side scripts for form processing are processing forms from your own site. People visit your site, log in, and submit a form to perform some action on your site. However, if your server-side code were simply looking for <code>$_POST</code> values to determine what to do, those values could be submitted from <em>any</em> form, even forms on other websites.</p>
<p>The first line of defense is to check that a user is really logged in and has the capabilities to do the requested action. However, this isn’t enough to stop CSRF attacks because you might be logged in on your WordPress site (e.g., in a background tab) while some malicious code on another site/tab kicks off the form request with the correct <code>$_POST</code> variable to send a spammy message to your friends or initiate account deletion or something else you don’t want to do.</p>
<p>What’s needed is a way to make sure that the request comes from the WordPress site and not another site. This is what a nonce does. The basic outline of using a nonce is as follows:</p>
<ol>
<li>Generate a nonce string every time a page is loaded.</li>
<li>Add the nonce string as a hidden element on the form.</li>
<li>When processing a submitted form, generate the nonce the same way and check that it matches the one submitted from the form.</li>
</ol>
<p>Because the nonce is generated using a combination of the secret salt keys in your <em>wp-config.php</em> and the server time, it is very hard for attackers to guess the nonce string for their own forms.</p>
<p>Nonces are useful for nonform links and AJAX calls as well. The process is basically the same:</p>
<ol>
<li>Generate a nonce string every time a page is loaded.</li>
<li>Add the nonce string as a parameter to the URL.</li>
<li>When processing the request, generate the nonce the same way and check that it matches the one submitted through the URL.</li>
</ol>
<p>Whether protecting your forms, links, or AJAX requests, WordPress has a few helper functions to make this process very easy to implement.</p>
<h4 id="wp-create-nonce-action-1"><a href="#wp-create-nonce-action-1" class="headerlink" title="wp_create_nonce( $action = -1 )"></a>wp_create_nonce( $action = -1 )</h4><p>This function creates a random token that can only be used once and is located in <em>wp-includes/pluggable.php</em>:</p>
<p>$action`—An optional string or int that describes what action is being taken for the nonce created. You should always set an action to be more secure:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">function schoolpress_footer_create_nonce()&#123;</div><div class="line">        $nonce = wp_create_nonce(&apos;random_nonce_action&apos;);</div><div class="line">        $url = add_query_arg( array( &apos;sp_nonce&apos; =&gt; $nonce ) );</div><div class="line">        echo &apos;&lt;p&gt;&lt;a href=&quot;&apos; . $url . &apos;&quot;&gt;Verify this Nonce&lt;/a&gt;&lt;/p&gt;&apos;;</div><div class="line">&#125;</div><div class="line">add_action( &apos;wp_footer&apos;, &apos;schoolpress_footer_create_nonce&apos; );</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<h4 id="wp-verify-nonce-nonce-action-1"><a href="#wp-verify-nonce-nonce-action-1" class="headerlink" title="wp_verify_nonce($nonce, $action = -1)"></a>wp_verify_nonce($nonce, $action = -1)</h4><p>This function is used to verify that the correct nonce was used within the allocated time limit. If the correct nonce is passed into this function and everything checks out OK, then the function will return a value that evaluates to <code>true</code>. If not, it will return <code>false</code>. This function is located in <em>wp-includes/pluggable.php</em>:</p>
<ul>
<li>$nonce—A required string of the nonce value being used to verify.</li>
<li>$action—An optional string or int that should be descriptive to what is taking place and should match the action from when the nonce was created.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">function schoolpress_init_verify_nonce()&#123;</div><div class="line">  if ( isset( $_GET[&apos;sp_nonce&apos;] )</div><div class="line">    &amp;&amp; wp_verify_nonce( $_GET[&apos;sp_nonce&apos;], &apos;random_nonce_action&apos; ) ) &#123;</div><div class="line">     echo &apos;You have a valid nonce!&apos;;</div><div class="line">    &#125; else &#123;</div><div class="line">     echo &apos;You have an invalid nonce!&apos;;</div><div class="line">        &#125;</div><div class="line">&#125;</div><div class="line">add_action( &apos;init&apos;, &apos;schoolpress_init_verify_nonce&apos; );</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<h4 id="check-admin-referer-action-1-queryarg-wpnonce"><a href="#check-admin-referer-action-1-queryarg-wpnonce" class="headerlink" title="check_admin_referer($action = -1, $queryarg = __wpnonce)"></a>check_admin_referer($action = -1, $query<em>arg = __wpnonce</em>)</h4><p>This function calls the <code>wp_verify_nonce</code> function, so it verifies nonces but also checks to see that the referrer or the page that got you to the current page you are on is from the same website. This function is located in <em>wp-includes/pluggable.php</em>:</p>
<ul>
<li>$action—An optional string, but you should specify a nonce action to be verified.</li>
<li>$query_arg—An optional string of the query argument that has the nonce as its value.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">// checking the same nonce &quot;sp_nonce&quot; that was created earlier</div><div class="line">function schoolpress_init_check_admin_referer()&#123;</div><div class="line">        if ( isset( $_GET[&apos;sp_nonce&apos;] )</div><div class="line">                &amp;&amp; check_admin_referer( &apos;random_nonce_action&apos;, &apos;sp_nonce&apos; ) ) &#123;</div><div class="line">                echo &apos;&lt;p&gt;You have a valid nonce!&lt;/p&gt;&apos;;</div><div class="line">        &#125; else &#123;</div><div class="line">                echo &apos;&lt;p&gt;You have an invalid nonce!&lt;/p&gt;&apos;;</div><div class="line">        &#125;</div><div class="line">&#125;</div><div class="line">add_action( &apos;init&apos;, &apos;schoolpress_init_check_admin_referer&apos; );</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<h4 id="wp-nonce-url-actionurl-action-1"><a href="#wp-nonce-url-actionurl-action-1" class="headerlink" title="wp_nonce_url( $actionurl, $action = -1 )"></a>wp_nonce_url( $actionurl, $action = -1 )</h4><p>This function also utilizes the <code>wp_create_nonce()</code> function and adds a nonce to any URL. If you create any actions based off of a query string, you should always tie a nonce to your URL with this function:</p>
<ul>
<li>$actionurl—A required string of the URL to add a nonce action to.</li>
<li>$action—An optional string for the action name. You should always set this.</li>
</ul>
<p>This function is located in <em>wp-includes/functions.php</em>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">// simple url with querystring example</div><div class="line">function schoolpress_footer_nonce_url()&#123;</div><div class="line">        $url = wp_nonce_url(</div><div class="line">                add_query_arg( array( &apos;action&apos; =&gt; &apos;get_users&apos; ) ),</div><div class="line">                &apos;get_users_nonce&apos;</div><div class="line">        );</div><div class="line">        echo &apos;&lt;p&gt;&lt;a href=&quot;&apos; . $url . &apos;&quot;&gt;Get Users&lt;/a&gt;&lt;/p&gt;&apos;;</div><div class="line">&#125;</div><div class="line">add_action( &apos;wp_footer&apos;, &apos;schoolpress_footer_nonce_url&apos; );</div><div class="line"></div><div class="line">// querystring action</div><div class="line">function schoolpress_footer_nonce_url_action()&#123;</div><div class="line">        // check if querystring action is get_users and for the nonce</div><div class="line">        if ( isset( $_GET[&apos;action&apos;] )</div><div class="line">                &amp;&amp; &apos;get_users&apos; == $_GET[&apos;action&apos;]</div><div class="line">                &amp;&amp; check_admin_referer( &apos;get_users_nonce&apos; ) ) &#123;</div><div class="line">                echo &apos;Your action: &apos; . $_GET[&apos;action&apos;];</div><div class="line">                // or get your users and display them here...</div><div class="line">        &#125;</div><div class="line">&#125;</div><div class="line">add_action( &apos;init&apos;, &apos;schoolpress_footer_nonce_url_action&apos; );</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<h4 id="wp-nonce-field-action-1-name-“-wpnonce”-referer-true-echo-true"><a href="#wp-nonce-field-action-1-name-“-wpnonce”-referer-true-echo-true" class="headerlink" title="wp_nonce_field( $action = -1, $name = “_wpnonce”, $referer = true , $echo = true )"></a>wp_nonce_field( $action = -1, $name = “_wpnonce”, $referer = true , $echo = true )</h4><p>This function retrieves or displays a hidden nonce field in a form. It has the <code>wp_create_nonce()</code> function baked into it, so you should always use this nice helper function when dealing with forms.</p>
<p>The nonce field is used to validate that the contents of the form came from the location on the current site and not somewhere else. The nonce does not offer absolute protection, but should protect against most cases. It is very important to use a nonce field in forms.</p>
<p>The <code>$action</code> and <code>$name</code> parameters are optional, but if you want to have better security, it is strongly suggested to set those two parameters. It is easier to just call the function without any parameters, because validation of the nonce doesn’t require any parameters, but since crackers know what the default is, it won’t be difficult for them to find a way around your nonce and cause damage.</p>
<p>The input name will be whatever <code>$name</code> value you gave. The input value will be the nonce creation value. This function is located in <em>wp-includes/functions.php</em>:</p>
<ul>
<li>$action—An optional string for the action name. You should always set this.</li>
<li>$name—An optional string for the nonce name. You should always set this.</li>
<li>$referer—An optional boolean of whether to set the referer field for validation. The default value is <code>true</code>.</li>
<li>$echo—An optional boolean of whether to display or return a hidden form field. The default value is <code>true</code>.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">// simple submission form example</div><div class="line">function schoolpress_footer_form()&#123;</div><div class="line">        ?&gt;</div><div class="line">        &lt;form method=&quot;post&quot;&gt;</div><div class="line">                &lt;?php // create our nonce</div><div class="line">                wp_nonce_field( &apos;email_list_form&apos;, &apos;email_list_form_nonce&apos; );</div><div class="line">                ?&gt;</div><div class="line">                &lt;h3&gt;Join our email list&lt;/h3&gt;</div><div class="line">                Email Address: &lt;input type=&quot;text&quot; name=&quot;email_address&quot;&gt;</div><div class="line">                &lt;input type=&quot;submit&quot; name=&quot;submit_email&quot; value=&quot;Submit&quot;&gt;</div><div class="line">        &lt;/form&gt;</div><div class="line">        &lt;?php</div><div class="line">&#125;</div><div class="line">add_action( &apos;wp_footer&apos;, &apos;schoolpress_footer_form&apos; );</div><div class="line"></div><div class="line">// form action</div><div class="line">function schoolpress_footer_form_action()&#123;</div><div class="line">        if ( isset( $_POST[&apos;submit_email&apos;] )</div><div class="line">                &amp;&amp; isset( $_POST[&apos;email_address&apos;] )</div><div class="line">                &amp;&amp; check_admin_referer( &apos;email_list_form&apos;,</div><div class="line">                 &apos;email_list_form_nonce&apos; ) ) &#123;</div><div class="line">                echo &apos;You submitted: &apos; . $_POST[&apos;email_address&apos;];</div><div class="line">                // or process your form here...</div><div class="line">        &#125;</div><div class="line">&#125;</div><div class="line">add_action( &apos;init&apos;, &apos;schoolpress_footer_form_action&apos; );</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<h4 id="check-ajax-referer-action-1-query-arg-false-die-true"><a href="#check-ajax-referer-action-1-query-arg-false-die-true" class="headerlink" title="check_ajax_referer( $action = -1, $query_arg = false, $die = true )"></a>check_ajax_referer( $action = -1, $query_arg = false, $die = true )</h4><p>When using AJAX, you should still be using nonces. This function allows you to do a nonce and referer check while processing an AJAX request. This function is located in <em>wp-includes/pluggable.php</em>:</p>
<ul>
<li>$action—An optional string of the nonce action being referenced.</li>
<li>$query_arg—An optional string of where to look for nonce in <code>$_REQUEST</code>.</li>
<li>$die—An optional boolean of whether you want to AJAX script to die if an invalid nonce is found.</li>
</ul>
<p>Throughout the book, you may have noticed code snippets that didn’t use nonces or sanitize data. We did this to try to keep the code examples short and sweet, but you should <em>always</em> use nonces and sanitize your data. Any custom form submission or URL with custom query strings should utilize nonces, and every time you write <code>$_POST[&#39;anything&#39;]</code> or <code>$_GET[&#39;anything&#39;]</code>, they should be wrapped in a sanitization or escaping function.</p>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2017-11-22T08:34:46.000Z" itemprop="dateUpdated">2017-11-22 16:34:46</time>
</span><br>


        
        这里可以写作者留言，标签和 hexo 中所有变量及辅助函数等均可调用，示例：<a href="/WordPress/2015-06-18-wordpress-security.html" target="_blank" rel="external">http://blog.inching.org/WordPress/2015-06-18-wordpress-security.html</a>
        
    </div>
    <footer>
        <a href="http://blog.inching.org">
            <img src="/img/avatar.png" alt="Cody Fei">
            Cody Fei
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tutorial/">tutorial</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wordpress/">wordpress</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.inching.org/WordPress/2015-06-18-wordpress-security.html&title=《WordPress Security》 — Balance&pic=http://blog.inching.org/img/avatar.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.inching.org/WordPress/2015-06-18-wordpress-security.html&title=《WordPress Security》 — Balance&source=Security BasicsThese are the simplest but most important security tips to con..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.inching.org/WordPress/2015-06-18-wordpress-security.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《WordPress Security》 — Balance&url=http://blog.inching.org/WordPress/2015-06-18-wordpress-security.html&via=http://blog.inching.org" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://blog.inching.org/WordPress/2015-06-18-wordpress-security.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/PhotoShop/2015-06-19-photoshop-cutout.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">PhotoShop 抠图</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/WordPress/2015-06-11-wordpress-dashboard.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">WordPress Dashboard</h4>
      </a>
    </div>
  
</nav>



    











</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.JPG" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.JPG" data-alipay="/img/alipay.JPG">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top" style="display:none">
        

        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>Cody Fei &copy; 2012 - 2017</span>
            <span style="display:none">
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.inching.org/WordPress/2015-06-18-wordpress-security.html&title=《WordPress Security》 — Balance&pic=http://blog.inching.org/img/avatar.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.inching.org/WordPress/2015-06-18-wordpress-security.html&title=《WordPress Security》 — Balance&source=Security BasicsThese are the simplest but most important security tips to con..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.inching.org/WordPress/2015-06-18-wordpress-security.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《WordPress Security》 — Balance&url=http://blog.inching.org/WordPress/2015-06-18-wordpress-security.html&via=http://blog.inching.org" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://blog.inching.org/WordPress/2015-06-18-wordpress-security.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACoElEQVR42u3aQY5iMQwFQO5/aUaa1Wyg37MTmpEqK/S7f0hlkRjbj0c8nn/H7Pnzn/F+/mQ8bgw8PDy80dLfT5cs9/3/vPrczpmvGQ8PD+82LzncN1+ZvzXboJfP8fDw8H6Vly/3/QXQHv14eHh4/y8vX2Iegs9IeHh4eN/AS47+PJG6CZrbd4/lWvDw8PAuVJG+5/PF+h4eHh7eoqo+uzCSFoFZAF2vEA8PD+8CbxMuz5bVbkH77dELeHh4eBd4+3J+27A126bkXTw8PLyzvLw01aZo2wJb/vxAMI2Hh4e34M3am/ZB86wANvwZgIeHh/cRXn4oz5q3knmS+YcXAx4eHt6a12LaBZ1qjco3pUjs4uHh4Y14s0M/X+4mubBpDsPDw8O7zWsP4mTq2Qz55uLh4eF9D28WRm+C74tpCzw8PLzLvFlxq23YmrVzDbcPDw8P7+O82fGdl9PaloI6cMfDw8O7zGsD1rxBapPsyDcdDw8P75O8TVtVnj6YJW1XjQV4eHh4R3lJOmBf1rp9hbx8goeHh3eNt0+qztqq2raAOtTGw8PD+yBvU7xPtiYva7XXyQ+/FfDw8PDWvPdHbf7jP28pmKUV2kYEPDw8vNu89iBuGwii1qh9oevVX/Hw8PAu8NrwevNlbQh+qvkADw8P7ywvOaDPlrva9Ecemkc9ZXh4eHiHeLMDevYkD4Xzd/Hw8PA+w3uW4z2gPrLLREad0sXDw8O7wMtHGxDn4W+eRD7VqoWHh4e357WXQQtLEsTtduSFOjw8PLx7vDaH0Ra98lB7doP9kJLAw8PD+1Ve21a1KWXNEhOriwEPDw/vKG+PyYP1TZsXHh4e3md47eLyJbZlqgMFLTw8PLzLvH0BbJP2zdOys7fw8PDwjvL+ADHdc6jsSHchAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="/js/main.min.js?v=1.6.17"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.6.17" async></script>










</body>
</html>
