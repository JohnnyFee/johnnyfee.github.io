<!DOCTYPE html>
<html>
<head>
    
<!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-43567748-2', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<!-- End Google Analytics -->


    

    



    <meta charset="utf-8">
    
    <meta name="google-site-verification" content="true">
    
    
    
    <title>WordPress JavaScript | Balance | 大道至简</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="tutorial,wordpress">
    <meta name="description" content="jQuery and WordPressWordPress comes installed with the latest version of jQuery, which is used in the admin dashboard for various UI and AJAX-related scripting. Because jQuery is already on your serve">
<meta property="og:type" content="article">
<meta property="og:title" content="WordPress JavaScript">
<meta property="og:url" content="http://blog.inching.org/WordPress/2015-06-19-wordpress-javascript.html">
<meta property="og:site_name" content="Balance">
<meta property="og:description" content="jQuery and WordPressWordPress comes installed with the latest version of jQuery, which is used in the admin dashboard for various UI and AJAX-related scripting. Because jQuery is already on your serve">
<meta property="og:updated_time" content="2017-11-05T08:22:17.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="WordPress JavaScript">
<meta name="twitter:description" content="jQuery and WordPressWordPress comes installed with the latest version of jQuery, which is used in the admin dashboard for various UI and AJAX-related scripting. Because jQuery is already on your serve">
    
        <link rel="alternate" type="application/atom+xml" title="Balance" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/style/style.css?v=1.6.17">

    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-2846834382442028",
        enable_page_level_ads: true
      });
    </script>

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.png">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Cody Fei</h5>
          <a href="mailto:inchingcode@gmail.com" title="inchingcode@gmail.com" class="mail">inchingcode@gmail.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                Home
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags/android"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/Android/"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/inchingorg" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://www.weibo.com/CodyFee" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.inesoi.com" target="_blank" >
                <i class="icon icon-lg icon-shopping-bag"></i>
                Shopping Bag
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">WordPress JavaScript</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">WordPress JavaScript</h1>
        <h5 class="subtitle">
            
                <time datetime="2015-06-18T16:00:00.000Z" itemprop="datePublished" class="page-time">
  2015-06-19
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/WordPress/">WordPress</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#jQuery-and-WordPress"><span class="post-toc-text">jQuery and WordPress</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Enqueuing-Other-JavaScript-Libraries"><span class="post-toc-text">Enqueuing Other JavaScript Libraries</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Where-to-Put-Your-Custom-JavaScript"><span class="post-toc-text">Where to Put Your Custom JavaScript</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#AJAX-Calls-with-WordPress-and-jQuery"><span class="post-toc-text">AJAX Calls with WordPress and jQuery</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Managing-Multiple-AJAX-Requests"><span class="post-toc-text">Managing Multiple AJAX Requests</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Heartbeat-API"><span class="post-toc-text">Heartbeat API</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Initialization"><span class="post-toc-text">Initialization</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Client-side-JavaScript"><span class="post-toc-text">Client-side JavaScript</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Server-side-PHP"><span class="post-toc-text">Server-side PHP</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#WordPress-Limitations-with-Asynchronous-Processing"><span class="post-toc-text">WordPress Limitations with Asynchronous Processing</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Backbone-js"><span class="post-toc-text">Backbone.js</span></a></li></ol>
        </nav>
    </aside>
    
<article id="post-wordpress-javascript"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">WordPress JavaScript</h1>
        <div class="post-meta">
            <time class="post-time" title="2015-06-19 00:00:00" datetime="2015-06-18T16:00:00.000Z"  itemprop="datePublished">2015-06-19</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/WordPress/">WordPress</a></li></ul>



            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h2 id="jQuery-and-WordPress"><a href="#jQuery-and-WordPress" class="headerlink" title="jQuery and WordPress"></a>jQuery and WordPress</h2><p>WordPress comes installed with the latest version of jQuery, which is used in the admin dashboard for various UI and AJAX-related scripting. Because jQuery is already on your server, including it in the frontend of your WordPress app is a breeze.</p>
<p>The jQuery JS file is located at <em>/wp-includes/lib/js/jquery.js</em>. Typically you would add a link like this to the <code>&lt;head&gt;</code> tag of your website to load jQuery:</p>
<a id="more"></a>
<pre><code>&lt;script lang=&quot;JavaScript&quot; src=&quot;/wp-includes/lib/js/jquery.js&quot; /&gt;
</code></pre><p>This will work if added to your theme’s <em>header.php</em> or through the <code>wp_head</code> hook; however, the proper way to include a JavaScript file in your WordPress site is to use the <code>wp_enqueue_script()</code> function. You can add the line <code>wp_enqueue_script(&#39;jquery&#39;);</code> to an init function called by the inside of your main plugin file, like so:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">function sp_enqueue_scripts()</div><div class="line">&#123;</div><div class="line">    wp_enqueue_script(&apos;jquery&apos;);</div><div class="line">&#125;</div><div class="line">add_action(&apos;init&apos;, &apos;sp_enqueue_scripts&apos;);</div></pre></td></tr></table></figure>
<p>The first parameter of the <code>wp_enqueue_script()</code> function is a label for the JavaScript file to enqueue. WordPress already knows what <code>jquery</code> is and where it’s located, so that is the only parameter you need to enqueue it.</p>
<h3 id="Enqueuing-Other-JavaScript-Libraries"><a href="#Enqueuing-Other-JavaScript-Libraries" class="headerlink" title="Enqueuing Other JavaScript Libraries"></a>Enqueuing Other JavaScript Libraries</h3><p>To enqueue other JavaScript libraries that WordPress doesn’t already know about, pass the full list of parameters. Your main app plugin may include code like this to load jQuery and any number of required JavaScript libraries. Also, instead of building your function on the <code>init</code> hook, you should use the <code>wp_enqueue_scripts</code> and <code>admin_enqueue_scripts</code> hooks. The <code>wp_enqueue_scripts</code> hook fires on the frontend just before enqueuing scripts, while the <code>admin_enqueue_scripts</code> hook fires in the dashboard just before enqueuing scripts:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">//frontend JS</div><div class="line">function sp_wp_enqueue_scripts() &#123;</div><div class="line">    wp_enqueue_script( &apos;jquery&apos; );</div><div class="line">        wp_enqueue_script(</div><div class="line">                &apos;schoolpress-plugin-frontend&apos;,</div><div class="line">                plugins_url( &apos;js/frontend.js&apos;, __FILE__ ),</div><div class="line">                array( &apos;jquery&apos; ),</div><div class="line">                &apos;1.0&apos;</div><div class="line">        );</div><div class="line">&#125;</div><div class="line">add_action( &quot;wp_enqueue_scripts&quot;, &quot;sp_wp_enqueue_scripts&quot; );</div><div class="line"></div><div class="line">//admin JS</div><div class="line">function sp_admin_enqueue_scripts() &#123;</div><div class="line">        wp_enqueue_script(</div><div class="line">                &apos;schoolpress-plugin-admin&apos;,</div><div class="line">                plugins_url( &apos;js/admin.js&apos;, __FILE__ ),</div><div class="line">                array( &apos;jquery&apos; ),</div><div class="line">                &apos;1.0&apos;</div><div class="line">        );</div><div class="line">&#125;</div><div class="line">add_action( &apos;admin_enqueue_scripts&apos;, &apos;sp_admin_enqueue_scripts&apos; );</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<p>Using <code>wp_enqueue_scripts</code> and <code>admin_enqueue_scripts</code> lets you load different JS files on the frontend and backend of your site. You could add other checks in here to make sure that jQuery is only loaded on certain pages, which could improve load times on those pages that don’t need jQuery loaded. Common methods include checking attributes of the global <code>$post</code> or checking <code>$_REQUEST</code> values used in the admin like <code>$_REQUEST[&#39;page&#39;]</code> or <code>$_REQUEST[&#39;post_type&#39;]</code>.</p>
<p>Remember, the first parameter of the <code>wp_enqueue_script()</code> function is a reference label. The second parameter of the _wp_enqueue<em>script()</em> function tells WordPress where the script is located. The <code>plugins_url()</code> function is used to figure out the URL relative to the current file <code>__FILE__</code>. This works when this code is included in the main plugin file. You would pass <code>dirname(__FILE__)</code> as the parameter to this call if the file you are editing is in a subdirectory of the plugin.</p>
<p>The third parameter of the <code>wp_enqueue_script()</code> function allows you to state dependencies for your script. By passing <code>array(&#39;jquery&#39;)</code> for our <em>frontend.js</em> and <em>admin.js</em> scripts, we make sure that jQuery is loaded first.</p>
<h3 id="Where-to-Put-Your-Custom-JavaScript"><a href="#Where-to-Put-Your-Custom-JavaScript" class="headerlink" title="Where to Put Your Custom JavaScript"></a>Where to Put Your Custom JavaScript</h3><p>Once again we will run into situations where we need to decide where to put a certain bit of code. Should it go into the theme code or the plugin code? Here are the general rules we use when deciding where a particular bit of JavaScript code will go:</p>
<ol>
<li>If the code will be only used once and is generally specific to the page it is used on, it is coded directly into that page within a <code>&lt;script&gt;</code> tag.</li>
<li>If the JavaScript is used more than once (a function or module) and is related to theme functionality or UI, it is placed in a JS file within the theme (e.g., <em>/themes/schoolpress/js/schoolpress.js</em>).</li>
<li>If the JavaScript is used more than once on admin screens of your app, it is placed in an <em>admin.js</em> file inside of your plugin (e.g., <em>/plugins/schoolpress/js/admin.js</em>).</li>
<li>If the JavaScript is used more than once on the frontend of your app, but not part of the theme UI, it is placed in a <em>frontend.js</em> file inside of your plugin (e.g., <em>/plugins/schoolpress/js/frontend.js</em>).</li>
<li>If splitting some JS code into its own file, to be loaded on specific pages, will result in a needed increase in performance, than that code will be placed in a separate JS file.<sup>[</sup>24]</li>
</ol>
<p>These rules are specific to how we like to develop and are only a suggestion. Some developers will cringe particularly hard at the thought of adding JavaScript code inside of script tags instead of placing all JavaScript inside of <em>.js</em> files. If you like coding this way or perhaps have a dedicated JavaScript programmer on your team, by all means put all of your JavaScript code inside of <em>.js</em> files.</p>
<p>The important thing is that <em>you</em> understand how your JavaScript files and code are organized so that working on your site is intuitive.</p>
<h2 id="AJAX-Calls-with-WordPress-and-jQuery"><a href="#AJAX-Calls-with-WordPress-and-jQuery" class="headerlink" title="AJAX Calls with WordPress and jQuery"></a>AJAX Calls with WordPress and jQuery</h2><p>AJAX calls in WordPress will require two components: the JavaScript code on the frontend to kick off the AJAX request and the PHP code in the backend to process the request and return HTML or JSON-encoded data.</p>
<p>Say you want to adjust your signup page to automatically check if the username entered has been used already. You could warn the person signing up before he hits the submit button and allow him to change the username he picked, saving a bit of grief.</p>
<p>The first thing we need to do is add a quick JavaScript to the head of our pages to define our <code>ajaxurl</code>. This is the URL that all AJAX queries will run through. It looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;script type=&quot;text/JavaScript&quot;&gt;</div><div class="line">var ajaxurl = &apos;/wp-admin/admin-ajax.php&apos;;</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>In the WordPress dashboard, this script will be embedded by default. But for frontend AJAX, we’ll need to embed it ourselves. Here’s the code to define the <code>ajaxurl</code> variable for frontend AJAX:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">function my_wp_head_ajax_url()</div><div class="line">&#123;</div><div class="line">?&gt;</div><div class="line">&lt;script type=”text/JavaScript”&gt;</div><div class="line">var ajaxurl = &apos;&lt;?php echo admin_url(&quot;admin-ajax.php&quot;);?&gt;&apos;;</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;?php</div><div class="line">&#125;</div><div class="line">add_action(&apos;wp_head&apos;, &apos;my_wp_head_ajax_url&apos;);</div></pre></td></tr></table></figure>
<p>Now the variable <code>ajaxurl</code> is available to the rest of the JavaScript on our frontend pages and can be used in our AJAX calls. Here is the JavaScript code to add to the bottom of the registration page to perform the username check:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">//our JS for the page</div><div class="line">function my_wp_footer_registration_JavaScript()</div><div class="line">&#123;</div><div class="line">    //make sure we&apos;re on the registration page</div><div class="line">    if(empty($_REQUEST[&apos;action&apos;]) || $_REQUEST[&apos;action&apos;] != ‘register’)</div><div class="line">        return;</div><div class="line">?&gt;</div><div class="line">&lt;script&gt;</div><div class="line">    //wait til DOM is loaded</div><div class="line">    jQuery(document).ready(function() &#123;</div><div class="line">        //var to keep track of our timeout</div><div class="line">        var timer_checkUsername;</div><div class="line"></div><div class="line">        //detect when the user_login field is changed</div><div class="line">        jQuery(&apos;#user_login&apos;).bind.(&apos;keyup change&apos;, function() &#123;</div><div class="line">            //use a timer so check is triggered 1 second after they stop typing</div><div class="line">            timer_checkUsername = setTimeout(function()&#123;checkUsername();&#125;, 1000);</div><div class="line">        &#125;);</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">    function checkUsername()</div><div class="line">    &#123;</div><div class="line">        //make sure we have a username</div><div class="line">        var username = jQuery(&apos;#user_login&apos;).val();</div><div class="line">        if(!username)</div><div class="line">            return;</div><div class="line"></div><div class="line">        //check the username</div><div class="line">        jQuery.ajax(&#123;</div><div class="line">        url: ajaxurl,type:&apos;GET&apos;,timeout:5000,</div><div class="line">                dataType: &apos;html&apos;,</div><div class="line">                data: &quot;action=check_username&amp;username=&quot;+username,</div><div class="line">                error: function(xml)&#123;</div><div class="line">                        //timeout, but no need to scare the user</div><div class="line">                &#125;,</div><div class="line">                success: function(response)&#123;</div><div class="line">                //hide any flag we may have already shown</div><div class="line">                jQuery(&apos;#username_check&apos;).remove();</div><div class="line"></div><div class="line">                //show if the username is good (1) or taken (0)</div><div class="line">                if(response == 1)</div><div class="line">                    jQuery(&apos;#user_login&apos;).after(</div><div class="line">                        &apos;&lt;span id=&quot;username_check&quot; class=&quot;okay&quot;&gt;Okay&lt;/span&gt;&apos;</div><div class="line">                    );</div><div class="line">                else</div><div class="line">                    jQuery(&apos;#user_login&apos;).after(</div><div class="line">                        &apos;&lt;span id=&quot;username_check&quot; class=&quot;taken&quot;&gt;Taken&lt;/span&gt;&apos;</div><div class="line">                    );</div><div class="line">                &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;?php</div><div class="line">&#125;</div><div class="line">add_action(&apos;wp_footer&apos;, &apos;my_wp_footer_registration_JavaScript&apos;);</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<p>The preceding code is hooked into <code>wp_footer</code> so the JavaScript will be added to the end of the HTML output. We first check that <code>$_REQUEST[&#39;action&#39;] == &quot;register&quot;</code> to make sure we’re on the default WP registration page.</p>
<p>If you’re using a plugin like Paid Memberships Pro that has its own registration page, you’ll want to use a check like <code>if(!is_page(&quot;membership-checkout&quot;))</code> to check which page you are on. You’ll also need to make sure that the <code>#user_login</code> check in your JavaScript code is updated to use the ID used for the username field on the registration page.</p>
<p>In the code, we use <code>jQuery(document).ready()</code> to detect that the DOM is loaded and then use <code>jQuery(&#39;#user_login&#39;).bind(&#39;keyup change&#39;, ...)</code> to detect when a user has either typed inside the field or otherwise changed it. When this happens, we use <code>setTimeout()</code> to queue up a username check in one second. If the user types again before the timer runs, it is reset to wait one second again. The effect is that one second after the user stops typing or changing the field, the <code>checkUsername()</code> function is kicked off.</p>
<p>In the <code>checkUsername()</code> function, we have the <code>jQuery.ajax()</code> call. Before we do that though, we check the value from the username field to see if it’s empty or not.</p>
<p>In the <code>jQuery.ajax()</code> call, we set the URL to <code>ajaxurl</code>, which should have been set via <code>wp_head</code> earlier.</p>
<p>We set the type of call to GET. You can also use the POST method. The DELETE and PUT methods are also available, but may not be supported by all browsers. Use the same logic you would when deciding which type to use on a <code>&lt;form&gt;</code> you are submitting to decide which method to use in an AJAX call. If you are “getting” data like we are in this example, GET makes sense. If you are submitting data to be saved, you can use the POST method.</p>
<p>We set a timeout of 5,000 (or 5 seconds) here. After this time, the request will be cancelled and the defined error action will be kicked off. You should set the timeout value based on the reasonable amount of time it might take your server to process this particular request. If you set it too low, you will prematurely cancel requests. If you set it too high, people will be waiting really long for requests that may have hung up on the server side.</p>
<p>We set the datatype to <code>html</code> here. This tells jQuery to take the output and place it into a string. A datatype of <code>json</code> will evaluate the output and place it into a JavaScript object variable. There are a few other datatypes including <code>xml</code>, <code>jsonp</code>, <code>script</code>, and <code>text</code>. The jQuery documentation addresses when you would use these and how jQuery processes each datatype.</p>
<p>We set the data to <code>&quot;action=check_username&amp;username=&quot;+username</code>, which will pass our defined action and the username as parameters to the <em>wp-admin-ajax.php</em> script and our service-side code.</p>
<p>Then we set a handler in case of errors and in case of success. In case of error, you could alert the user, but since this isn’t a critical function, we just go about our business. In case of success, we remove the old <code>#username_check</code> element and append an “OK” or “Taken” message after the username field.</p>
<p>Now let’s see the backend code. Here is the code you would put into <em>functions.php</em>, your custom plugin, or a <em>.php</em> in your plugin’s <em>/services/</em> directory to listen for the AJAX request and send back a <code>1</code> or <code>0</code> if a username if available or not:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">//detect AJAX request for check_username</div><div class="line">function wp_ajax_check_username() &#123;</div><div class="line">    global $wpdb;</div><div class="line">        $username = $_REQUEST[&apos;username&apos;];</div><div class="line"></div><div class="line">        $taken = $wpdb-&gt;get_var( &quot;</div><div class="line">                SELECT user_login</div><div class="line">                FROM $wpdb-&gt;users</div><div class="line">                WHERE user_login = &apos;&quot; . $wpdb-&gt;escape( $username ) . &quot;&apos; LIMIT 1&quot;</div><div class="line">                );</div><div class="line"></div><div class="line">        if ( $taken )</div><div class="line">                echo &quot;0&quot;;   //taken</div><div class="line">        else</div><div class="line">                echo &quot;1&quot;;   //available</div><div class="line">&#125;</div><div class="line">add_action( &apos;wp_ajax_check_username&apos;, &apos;wp_ajax_check_username&apos; );</div><div class="line">add_action( &apos;wp_ajax_nopriv_check_username&apos;, &apos;wp_ajax_check_username&apos; );</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<ul>
<li><code>wp_ajax_{action}</code>—Runs for logged-in users</li>
<li><code>wp_ajax_nopriv_{action}</code>—Runs for nonusers</li>
</ul>
<p>On the registration page, users are by definition not logged in, so we need to use the <code>wp_ajax_nopriv_</code> hook. But we may also want to use this check on the add new user screen in the admin, so we’ll hook into <code>wp_ajax_</code> as well to handle that case.</p>
<p>If you have an AJAX service that will only be used by users, just use the <code>wp_ajax_ hook</code>. If you need your service available for users and nonusers, you’ll need to use both hooks.</p>
<p>Also, notice how the <code>action</code> parameter we’re looking for (“check_username”) is added to the hook in the action definition. This hook will only fire if <code>$_REQUEST[&#39;action&#39;] == &quot;check_username&quot;</code>.</p>
<h2 id="Managing-Multiple-AJAX-Requests"><a href="#Managing-Multiple-AJAX-Requests" class="headerlink" title="Managing Multiple AJAX Requests"></a>Managing Multiple AJAX Requests</h2><p>When working with AJAX requests, it’s important to keep track of them. If not, you can put undue stress on your server and the client’s browser, leading to a lockup of their session or the entire site.</p>
<p>For example, in the preceding code, we wait one second after the username field is updated before kicking off the AJAX request to check if the username is available. But once the request goes out, the user might keep on typing, kicking off another AJAX request. If your server isn’t able to get back within one second, those requests might start to build up on each other.</p>
<p>Now, our username checker might not have too much potential to get out of hand, but it’s possible in a lot of situations. A simple example would be one where an AJAX request is kicked off when a user clicks a button. If the user clicks the button 20 times, that could be 20 hits on your server. So keep track of them.</p>
<p>Generally, you want to do one of two things when managing your AJAX requests:</p>
<ol>
<li>Keep a user from submitting a request if another request of the same type is still processing.</li>
<li>Cancel any existing request of the same type if a new request is submitted.</li>
</ol>
<p>Which option you use depends on what the AJAX request is doing. Generally if you are “getting” data, you’ll want to cancel earlier requests and submit the fresher one. If you are “posting” data, you’ll want to ignore the new request until the old one is completed.</p>
<p>Depending on your app and the request at hand, there will be many ways to disable or cancel requests. Since the “complete” callback in jQuery’s <code>ajax</code> method is called whether the request is successful or errors out, you can use it to re-enable a button or other element that’s being used to kick off a specific AJAX request:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">//Option #1: Disabling a button while an AJAX request is processing</div><div class="line">jQuery(&apos;#button&apos;).click(function() &#123;</div><div class="line">    //disable the button</div><div class="line">    jQuery(this).attr(&apos;disabled&apos;, &apos;disabled&apos;);</div><div class="line"></div><div class="line">    //do the ajax request</div><div class="line">    jQuery.ajax(&#123;</div><div class="line">        url: ajaxurl,type:&apos;GET&apos;,timeout:5000,</div><div class="line">        dataType: &apos;html&apos;,</div><div class="line">        error: function(xml)&#123;</div><div class="line">                //error stuff</div><div class="line">        &#125;,</div><div class="line">        success: function(response)&#123;</div><div class="line">            //success stuff</div><div class="line">        &#125;</div><div class="line">        complete: function() &#123;</div><div class="line">            //enable the button again</div><div class="line">            jQuery(&apos;#button&apos;).removeAttr(&apos;disabled&apos;);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Similarly, here is some code that will cancel an old request when a new one comes in:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">//Option #2: Cancel an older request when a new one comes in</div><div class="line">var ajax_request;</div><div class="line">jQuery(&apos;#button&apos;).click(function() &#123;</div><div class="line">    //cancel any existing requests</div><div class="line">    if(typeof ajax_request !== &apos;undefined&apos;)</div><div class="line">        ajax_request.abort();</div><div class="line"></div><div class="line">    //do the ajax request</div><div class="line">    ajax_request = jQuery.ajax(&#123;</div><div class="line">        url: ajaxurl,type:&apos;GET&apos;,timeout:5000,</div><div class="line">        dataType: &apos;html&apos;,</div><div class="line">        error: function(xml)&#123;</div><div class="line">                //error stuff</div><div class="line">        &#125;,</div><div class="line">        success: function(response)&#123;</div><div class="line">            //success stuff</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="Heartbeat-API"><a href="#Heartbeat-API" class="headerlink" title="Heartbeat API"></a>Heartbeat API</h2><p>Earlier in this chapter, we built an AJAX call that was triggered by a form field being updated. Sometimes you will want certain updates to happen on their own periodically as your web app is running. For example, you may want to check for new comments on a discussion forum and automatically pull in fresh comments as they are posted. With JavaScript, this is typically done by polling the backend every few seconds using an AJAX call kicked off by the <code>setInterval</code> function. Alternatively, you can use the WordPress Heartbeat API.</p>
<p>The Heartbeat API is new to WordPress 3.6 and can be used to facilitate quasi-realtime updates in your app. Every 15 seconds (or less if you change the settings), your app will send a heartbeat request from the client to the server and back. During this round trip, you can do things like autosave app states or load fresh content. In WordPress 3.6, the Heartbeat API is being used for autosaving posts, locking posts, and giving login expiration warnings. In this section, we’ll cover how you can use the Heartbeat API for your app.</p>
<p>Like anything else, the Heartbeat API can seem complicated, but at its heart, it’s simply a bunch of data passed back and forth from the client to the server through periodic AJAX calls. Using hooks, you can tap into the data being sent or received to get the information you need to and from the server.</p>
<p>Here is a minimal example demonstrating the Heartbeat API. The only thing this code does is send a message <code>marco</code> to the server. If the server sees that message, it sends <code>polo</code> back to the client. Both messages are logged to the JavaScript console, so every 15 seconds, you should see the following in your console:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Client: marco</div><div class="line">Server: polo</div></pre></td></tr></table></figure>
<p>Using the Heartbeat API can be broken down into three sections: initialization, client-side JavaScript, and server-side PHP:</p>
<h3 id="Initialization"><a href="#Initialization" class="headerlink" title="Initialization"></a>Initialization</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">//enqueue heartbeat.js and our JavaScript</div><div class="line">function hbdemo_init()</div><div class="line">&#123;</div><div class="line">    /*</div><div class="line">        //Add your conditionals here so this runs on the pages you want, e.g.</div><div class="line">                if(is_admin())</div><div class="line">                        return;                 //don&apos;t run this in the admin</div><div class="line">        */</div><div class="line"></div><div class="line">    //enqueue the Heartbeat API</div><div class="line">    wp_enqueue_script(&apos;heartbeat&apos;);</div><div class="line"></div><div class="line">    //load our JavaScript in the footer</div><div class="line">    add_action(&quot;wp_footer&quot;, &quot;hbdemo_wp_footer&quot;);</div><div class="line">&#125;</div><div class="line">add_action(&apos;init&apos;, &apos;hbdemo_init&apos;);</div></pre></td></tr></table></figure>
<p>This first function enqueues the <em>heartbeat.js</em> file and sets up an action to put our JavaScript code in the the footer via the <code>wp_footer</code> hook. If you only wanted this heartbeat code to run on certain pages (very likely), you would put your checks here.</p>
<h3 id="Client-side-JavaScript"><a href="#Client-side-JavaScript" class="headerlink" title="Client-side JavaScript"></a>Client-side JavaScript</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">//our JavaScript to send/process from the client side</div><div class="line">function hbdemo_wp_footer()</div><div class="line">&#123;</div><div class="line">?&gt;</div><div class="line">&lt;script&gt;</div><div class="line">  jQuery(document).ready(function() &#123;</div><div class="line">        //hook into heartbeat-send: client will send the message</div><div class="line">        //&apos;marco&apos; in the &apos;client&apos; var inside the data array</div><div class="line">        jQuery(document).on(&apos;heartbeat-send&apos;, function(e, data) &#123;</div><div class="line">                console.log(&apos;Client: marco&apos;);</div><div class="line"></div><div class="line">                //need some data to kick off AJAX call</div><div class="line">                data[&apos;client&apos;] = &apos;marco&apos;;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        //hook into heartbeat-tick: client looks for a &apos;server&apos;</div><div class="line">        //var in the data array and logs it to console</div><div class="line">        jQuery(document).on(&apos;heartbeat-tick&apos;, function(e, data) &#123;</div><div class="line">                if(data[&apos;server&apos;])</div><div class="line">                        console.log(&apos;Server: &apos; + data[&apos;server&apos;]);</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        //hook into heartbeat-error to log errors</div><div class="line">        jQuery(document).on(&apos;heartbeat-error&apos;,</div><div class="line">                function(e, jqXHR, textStatus, error) &#123;</div><div class="line">                        console.log(&apos;BEGIN ERROR&apos;);</div><div class="line">                        console.log(textStatus);</div><div class="line">                        console.log(error);</div><div class="line">                        console.log(&apos;END ERROR&apos;);</div><div class="line">                &#125;);</div><div class="line">  &#125;);</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;?php</div><div class="line">&#125;</div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<p>This second function dumps our JavaScript into the footer. In the JavaScript code, we use <code>jQuery(document).ready()</code> to run our code after the DOM has loaded. Then we hook into three JavaScript events triggered by the Heartbeat API:</p>
<ol>
<li>The <code>heartbeat-send</code> event is fired right before the heartbeat sends data back to the server. To send your data, add a value to the “data” array passed through the event.</li>
<li>The <code>heartbeat-tick</code> event is fired when the server replies. To see what data the server has sent, look for it in the “data” array that is passed through the event.</li>
<li>The <code>heartbeat-error</code> event is fired if there is an error in the <code>jQuery.ajax()</code> call used to send the data to the server. You can include code here for debugging or degrade nicely if AJAX doesn’t seem to be working in your production environment.</li>
</ol>
<h3 id="Server-side-PHP"><a href="#Server-side-PHP" class="headerlink" title="Server-side PHP"></a>Server-side PHP</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">//processing the message on the server</div><div class="line">function hbdemo_heartbeat_received($response, $data)</div><div class="line">&#123;</div><div class="line">    if($data[&apos;client&apos;] == &apos;marco&apos;)</div><div class="line">                $response[&apos;server&apos;] = &apos;polo&apos;;</div><div class="line"></div><div class="line">        return $response;</div><div class="line">&#125;</div><div class="line">add_filter(&apos;heartbeat_received&apos;, &apos;hbdemo_heartbeat_received&apos;, 10, 2);</div></pre></td></tr></table></figure>
<p>This third PHP function in the previous example runs on the <code>heartbeat_received</code> hook and processes the data from the client. We can add data to go back to the client by updating the <code>response</code> variable.</p>
<p>Now let’s try a more realistic example. SchoolPress has a section of the assignments page showing how many assignments have been submitted and how many are left. Let’s use the Heartbeat API to update this number if new assignments have been posted.</p>
<p>In our template, the assignment count will be displayed something like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">?&gt;</div><div class="line">&lt;div&gt;</div><div class="line">    Submitted:</div><div class="line">    &lt;span id=&quot;assignment_count&quot;&gt;</div><div class="line">        &lt;?php echo count($assignment-&gt;submissions);?&gt;</div><div class="line">    &lt;/span&gt;</div><div class="line">    /</div><div class="line">    &lt;?php echo count($course-&gt;students);?&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;?php</div></pre></td></tr></table></figure>
<h2 id="WordPress-Limitations-with-Asynchronous-Processing"><a href="#WordPress-Limitations-with-Asynchronous-Processing" class="headerlink" title="WordPress Limitations with Asynchronous Processing"></a>WordPress Limitations with Asynchronous Processing</h2><p>Most WordPress applications execute PHP scripts through an Apache or Nginx server. When optimized, you can serve a lot of small, simultaneous connections on these setups, which is perfect for asynchronous JavaScript applications. However, the servers themselves, and perhaps more importantly, the general overhead of loading WordPress on server-side calls, means that a WordPress service running on Apache or Nginx will never be as fast as a smaller JavaScript service running on something like <em>node.js</em>, which was built specifically to handle asynchronous JavaScript calls.</p>
<p>That said, you can still get a lot done with WordPress and the architecture behind it. Our suggestion is always to build it the obvious way first and selectively pull out parts of your application for scaling later when performance becomes an issue.</p>
<p>Does your app have a user base consisting solely of the 30 people inside your company? Then you are probably going to be fine using WordPress for your realtime JavaScript coding.</p>
<p>Do you plan to have thousands of users, with dozens of simultaneous connections? You’ll need some beefy hardware, but you’ll also probably be fine keeping everything in WordPress.</p>
<p>Do you plan to have millions of users, with tens of thousands of simultaneous connections? If so, you need some top-notch engineers, so hopefully you have the money for them. In any case, you’ll either be pushing WordPress to its limits or using other platforms to serve your realtime interactions.</p>
<h2 id="Backbone-js"><a href="#Backbone-js" class="headerlink" title="Backbone.js"></a>Backbone.js</h2><p>When people say that you can’t build apps with WordPress, we point out that WordPress itself is an application built on the WordPress framework. That WordPress application is currently about 86% PHP and 14% JavaScript. Some people in the WordPress community expect that ratio to get closer to 50/50 over the next few years.</p>
<p>Why the big move to JavaScript? On the frontend side of things, rendering a website with JavaScript can be much lighter than rendering it with PHP. As you navigate around the typical website, loading all of the HTML DOM is pretty wasteful. The header, footer, menu, and other pieces of the site may not change at all. With JavaScript, you can simply load the new part of the website, change the class on the items in your menu, and voila: new page. This is a much more app-like experience and perfect for using web apps over mobile networks where bandwidth is more scarce.</p>
<p>Using AJAX to update pages instead of loading new pages is sometimes referred to as building a single page application, or SPA.</p>
<p>One thing limiting a move to JavaScript is that all of our handy functions and data structures are native to PHP. As more development is done on the JavaScript side of the WordPress platform, there is a greater need for some kind of framework to help organize the JavaScript development.</p>
<p>Backbone.js is a framework for JavaScript consisting of models, views, and collections of models. This setup is very similar to the MVC frameworks used for server-side PHP development. In traditional MVC frameworks, the C stands for “controller.” With Backbone.js, the controlling of an app is handled within the views and honestly outside of the JavaScript framework itself.</p>
<p>Backbone.js has already been used extensively in the Media Library and Theme Customizer updated and added in recent versions of WordPress. The JavaScript developers working on the WordPress core will likely transition more of the platform code to use Backbone.js as they build out new features and rework old ones. For this reason, it is becoming more common to see developers building their themes and apps using Backbone.js as well.</p>
<p>The best practices for Backbone.js development, let alone Backbone+WordPress development, are still being worked out. In general, if you are simply adding some dynamic AJAX-based UI to an existing PHP-based page, the more traditional AJAX technique laid out here will be faster and easier to implement and maintain. However, if a fairly large portion of your app will live inside of JavaScript, a Backbone.js implementation will help you organize things and will make things easier for you. Backbone.js is not the kind of tool to use piecemeal. It works best when you go all in with it.</p>
<p>If you are using Backbone.js to render the frontend of your app, the main intersection point with WordPress will be when your collections and models are saved to the database through the backend.</p>
<p>Imagine an interface on the SchoolPress site for adding student groups to an assignment. There may be an input box for naming the group and a button labeled Add Group to add the group. Using the traditional AJAX technique outlined in this chapter, the turn of events would look like this:</p>
<ol>
<li>User enters a new group name.</li>
<li>User clicks the Add Group button.</li>
<li>The group name is sent to the server via AJAX.</li>
<li>The server (WordPress) processes the name, adds the new group, and returns some data.</li>
<li>The client uses JavaScript to parse the response and update the list of groups on the frontend.</li>
</ol>
<p>With a Backbone.js app, you mirror the list of groups more thoroughly in the model and collection you would set up in JavaScript. You could use a similar workflow as the typical AJAX app, but a more appropriate workflow for a Backbone.js app would be:</p>
<ol>
<li>User enters a new group name.</li>
<li>User clicks the Add Group button.</li>
<li>The group name is used to create a new instance of the group model and added to the group collection in Backbone.js.</li>
<li>The collection will be coded to update the server (WordPress) through AJAX whenever the collection changes.</li>
<li>A representation of the current collection of groups is sent to the server.</li>
<li>WordPress updates the internal representation of the collection in the database to match what was sent.</li>
</ol>
<p>So instead of first updating things in the backend and the backend telling the frontend what to look like, with Backbone.js things are first updated on the frontend, and the frontend tells the backend how to save the data.</p>
<p>An example of some SchoolPress functionality coded both with the traditional AJAX technique and then using Backbone.js can be found at <em><a href="http://bwawwp.com/backbonejs-example/" target="_blank" rel="external">http://bwawwp.com/backbonejs-example/</a></em>.</p>
<p>Here are some resources to learn more about Backbone.js and how to use it with WordPress:</p>
<ul>
<li><a href="http://backbonejs.org/" target="_blank" rel="external">Official Backbone.js site</a></li>
<li><a href="http://bit.ly/bb-wp-knight" target="_blank" rel="external">“Backbone.js and WordPress Resources”</a> by Peter R. Knight</li>
</ul>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2017-11-05T08:22:17.000Z" itemprop="dateUpdated">2017-11-05 16:22:17</time>
</span><br>


        
        这里可以写作者留言，标签和 hexo 中所有变量及辅助函数等均可调用，示例：<a href="/WordPress/2015-06-19-wordpress-javascript.html" target="_blank" rel="external">http://blog.inching.org/WordPress/2015-06-19-wordpress-javascript.html</a>
        
    </div>
    <footer>
        <a href="http://blog.inching.org">
            <img src="/img/avatar.png" alt="Cody Fei">
            Cody Fei
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tutorial/">tutorial</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wordpress/">wordpress</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.inching.org/WordPress/2015-06-19-wordpress-javascript.html&title=《WordPress JavaScript》 — Balance&pic=http://blog.inching.org/img/avatar.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.inching.org/WordPress/2015-06-19-wordpress-javascript.html&title=《WordPress JavaScript》 — Balance&source=jQuery and WordPressWordPress comes installed with the latest version of jQue..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.inching.org/WordPress/2015-06-19-wordpress-javascript.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《WordPress JavaScript》 — Balance&url=http://blog.inching.org/WordPress/2015-06-19-wordpress-javascript.html&via=http://blog.inching.org" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://blog.inching.org/WordPress/2015-06-19-wordpress-javascript.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/WordPress/2015-06-20-wordpress-library.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">PHP Libraries, External APIs, and Web Services</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/PhotoShop/2015-06-19-photoshop-cutout.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">PhotoShop 抠图</h4>
      </a>
    </div>
  
</nav>



    











</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.JPG" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.JPG" data-alipay="/img/alipay.JPG">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top" style="display:none">
        

        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>Cody Fei &copy; 2012 - 2018</span>
            <span style="display:none">
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.inching.org/WordPress/2015-06-19-wordpress-javascript.html&title=《WordPress JavaScript》 — Balance&pic=http://blog.inching.org/img/avatar.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.inching.org/WordPress/2015-06-19-wordpress-javascript.html&title=《WordPress JavaScript》 — Balance&source=jQuery and WordPressWordPress comes installed with the latest version of jQue..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.inching.org/WordPress/2015-06-19-wordpress-javascript.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《WordPress JavaScript》 — Balance&url=http://blog.inching.org/WordPress/2015-06-19-wordpress-javascript.html&via=http://blog.inching.org" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://blog.inching.org/WordPress/2015-06-19-wordpress-javascript.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACu0lEQVR42u3awVLrQAwEwPz/T/OuULyEGWkXcmifKOI42z545ZEej/j4+HY8+3R2hc/nPLvm6+uvDjw8PLz10p9d+vU5m+UmZw7Xg4eHh3eNlywuf9wnS0luRHI7frDg4eHhvRnvdUn9uvhOzm/Lazw8PLx35n3ER15Az66Ah4eH91e8/NKzmDUJcDdl94GsBQ8PD2+Suz7yQPZv/77S38PDw8Nbd9XbRlcbLrStr3q1eHh4eBd4+QO3bXG1JXu7ORU3Gg8PD+8oLw8Ikg0gH5bK44x2GOvLt/Dw8PAu85JH9qnIoGXPbjoeHh7eDd7sYZ3kpdEPl6HGqr+Hh4eHd4HXhrZ5DLEJF/JSu26D4eHh4Y14s5ZSXnzP8G20cbi/h4eHh7fmtZvHrEBP4olkq/hPZw8PDw/vGm9TvM4aVy2yfg3Aw8PDu8ZrW1xtY2zTNtuEI3h4eHg3eJum1KzY3WwSeYiMh4eHd4/XNvtXoWrZPMtJUQMMDw8P7xBvFpjuA9n8pszOx8PDw7vHS8rf/RTTJuzYjB3g4eHh3eDl4cKsVZacn5fL+1AYDw8P7xRvs5RNM2wWB9dxMx4eHt5lXgtLvnv2P204goeHh3eDlx95UduODuQ3t+1w4eHh4d3gzX4gDwtuRBjF6AMeHh7er/Daxlhb7LZBQ/saUOxLeHh4eAteXqRuBqraMj0poIejV3h4eHhrXr49rB7TozGC9mrRvoeHh4c34p0aP80HW3PkrKz/cmU8PDy8C7zNy3+7bbxeYhsBHx4gwMPDwyt5yWaQF7ttuZyEC/m2MXxjwMPDwxvx8mGmHL+JaDfHDyk1Hh4e3q/zZjFrvuVs2nJPS2o8PDy8t+HlgewsnM23nLo/hoeHh7fmtUFAi98EuKvBBTw8PLwLvPr1PhggyB/07a+fCizw8PDwRt/6B5IGK/DSWXzLAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="/js/main.min.js?v=1.6.17"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.6.17" async></script>










</body>
</html>
