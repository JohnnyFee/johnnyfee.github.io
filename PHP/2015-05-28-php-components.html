<!DOCTYPE html>
<html>
<head>
    
<!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-43567748-2', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<!-- End Google Analytics -->


    

    



    <meta charset="utf-8">
    
    <meta name="google-site-verification" content="true">
    
    
    
    <title>PHP Components | Balance | 大道至简</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="tutorial,php">
    <meta name="description" content="See 《Modern PHP》 and 《Learning PHP, MySQL &amp;amp; JavaScript, 4th Edition》.
The most popular modern PHP frameworks include:

Aura
Laravel
Symfony
Yii
Zend">
<meta property="og:type" content="article">
<meta property="og:title" content="PHP Components">
<meta property="og:url" content="http://blog.inching.org/PHP/2015-05-28-php-components.html">
<meta property="og:site_name" content="Balance">
<meta property="og:description" content="See 《Modern PHP》 and 《Learning PHP, MySQL &amp;amp; JavaScript, 4th Edition》.
The most popular modern PHP frameworks include:

Aura
Laravel
Symfony
Yii
Zend">
<meta property="og:updated_time" content="2017-11-05T08:22:17.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PHP Components">
<meta name="twitter:description" content="See 《Modern PHP》 and 《Learning PHP, MySQL &amp;amp; JavaScript, 4th Edition》.
The most popular modern PHP frameworks include:

Aura
Laravel
Symfony
Yii
Zend">
    
        <link rel="alternate" type="application/atom+xml" title="Balance" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/style/style.css?v=1.6.17">

    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-2846834382442028",
        enable_page_level_ads: true
      });
    </script>

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.png">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Cody Fei</h5>
          <a href="mailto:inchingcode@gmail.com" title="inchingcode@gmail.com" class="mail">inchingcode@gmail.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                Home
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags/android"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/Android/"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/inchingorg" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://www.weibo.com/CodyFee" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.inesoi.com" target="_blank" >
                <i class="icon icon-lg icon-shopping-bag"></i>
                Shopping Bag
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">PHP Components</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">PHP Components</h1>
        <h5 class="subtitle">
            
                <time datetime="2015-05-27T16:00:00.000Z" itemprop="datePublished" class="page-time">
  2015-05-28
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/PHP/">PHP</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Find-Components"><span class="post-toc-text">Find Components</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Use-PHP-Components"><span class="post-toc-text">Use PHP Components</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Install-Composer"><span class="post-toc-text">Install Composer</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Use-Composer"><span class="post-toc-text">Use Composer</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Autoloading-PHP-components"><span class="post-toc-text">Autoloading PHP components</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Create-PHP-Components"><span class="post-toc-text">Create PHP Components</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Filesystem-Organization"><span class="post-toc-text">Filesystem Organization</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#The-composer-json-File"><span class="post-toc-text">The composer.json File</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Component-Implementation"><span class="post-toc-text">Component Implementation</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Packagist-Submission"><span class="post-toc-text">Packagist Submission</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Using-the-Component"><span class="post-toc-text">Using the Component</span></a></li></ol></li></ol>
        </nav>
    </aside>
    
<article id="post-php-components"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">PHP Components</h1>
        <div class="post-meta">
            <time class="post-time" title="2015-05-28 00:00:00" datetime="2015-05-27T16:00:00.000Z"  itemprop="datePublished">2015-05-28</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/PHP/">PHP</a></li></ul>



            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p>See <a href="http://www.salttiger.com/modern-php/" target="_blank" rel="external">《Modern PHP》</a> and <a href="http://www.salttiger.com/learning-php-mysql-javascript-4th-edition/" target="_blank" rel="external">《Learning PHP, MySQL &amp; JavaScript, 4th Edition》</a>.</p>
<p>The most popular modern PHP frameworks include:</p>
<ul>
<li><a href="http://auraphp.com/framework" target="_blank" rel="external">Aura</a></li>
<li><a href="http://laravel.com/" target="_blank" rel="external">Laravel</a></li>
<li><a href="http://symfony.com/" target="_blank" rel="external">Symfony</a></li>
<li><a href="http://www.yiiframework.com/" target="_blank" rel="external">Yii</a></li>
<li><a href="http://framework.zend.com/" target="_blank" rel="external">Zend</a></li>
</ul>
<a id="more"></a>
<p>Should you use components or a framework? <em>Use the right tool for the job</em>. Most modern PHP frameworks are only a set of conventions built atop smaller PHP components.If you are working on a smaller project that can be solved with a precise collection of PHP components, then use components. Components make it super-easy to shop for and use existing tools so we can focus less on boilerplate and more on the larger task at hand. Components also help our code remain lightweight and nimble. We use only the code we need, and it’s super-easy to swap one component with another that may be better suited for our project.</p>
<p>If you are working on a large project with multiple team members and can benefit from the conventions, discipline, and structure provided by a framework, then use a framework. However, frameworks make many decisions for us and require us to adhere to its set of conventions. Frameworks are less flexible, but we do get far more out-of-the-box than we do with a collection of PHP components. If these tradeoffs are acceptable, by all means use a framework to guide and expedite your project development.</p>
<h2 id="Find-Components"><a href="#Find-Components" class="headerlink" title="Find Components"></a>Find Components</h2><ul>
<li><a href="https://packagist.org/" target="_blank" rel="external">Packagist</a></li>
<li><a href="https://github.com/ziadoz/awesome-php" target="_blank" rel="external">ziadoz/awesome-php</a></li>
</ul>
<h2 id="Use-PHP-Components"><a href="#Use-PHP-Components" class="headerlink" title="Use PHP Components"></a>Use PHP Components</h2><p><a href="https://getcomposer.org/" target="_blank" rel="external">Composer</a> is how you install PHP components. Composer is a dependency manager for PHP components that runs on the command line. You tell Composer which PHP components you need, and Composer downloads and autoloads the components into your project. It’s as simple as that. Because Composer is a dependency manager, it also resolves and downloads your components’ dependencies (and their dependencies, <em>ad infinitum</em>).</p>
<p>Composer works hand-in-hand with Packagist, too. When you tell Composer you want to use the <code>guzzlehttp/guzzle</code> component, Composer fetches the <code>guzzlehttp/guzzle</code> component listing on Packagist, finds the component’s repository URL, determines the appropriate version to use, and discovers the component’s dependencies. Composer then downloads the <code>guzzlehttp/guzzle</code> component and its dependencies into your project.</p>
<p>Composer is important because dependency management and autoloading are hard problems to solve. Autoloading is the process of automatically loading PHP classes on-demand without explicitly loading them with the <code>require()</code>, <code>require_once()</code>, <code>include()</code>, or <code>include_once()</code> functions. Older PHP versions let us write custom autoloaders with the <code>\__autoload()</code> function; this function is automatically invoked by the PHP interpreter when we instantiate a class that has not already been loaded. PHP later introduced the more flexible <code>spl_autoload_register()</code> function in its SPL library. Exactly how a PHP class is autoloaded is entirely up to the developer. Unfortunately, the lack of a common autoloader standard often necessitates a unique autoloader implementation for every project. This makes it difficult to use code created and shared by other developers if each developer provides a unique autoloader.</p>
<p>The PHP Framework Interop Group recognized this problem and created the PSR-0 standard (superseded by the PSR-4 standard). The PSR-0 and PSR-4 standards suggest how to organize code into namespaces and filesystem directories so it is compatible with one standard autoloader implementation. We don’t have to write a PSR-4 autoloader on our own. Instead, the Composer dependency manager automatically generates a PSR-compatible autoloader for <em>all</em> of our project’s PHP components. Composer effectively abstracts away dependency management and autoloading.</p>
<h2 id="Install-Composer"><a href="#Install-Composer" class="headerlink" title="Install Composer"></a>Install Composer</h2><p>Composer is easy to install. Open a terminal and execute this command:</p>
<pre><code>curl -sS https://getcomposer.org/installer | php
</code></pre><p>This command downloads the Composer installer script with <code>curl</code>, executes the installer script with <code>php</code>, and creates a <em>composer.phar</em> file in the current working directory. The <em>composer.phar</em> file is the Composer binary.</p>
<p>I prefer to move and rename the downloaded Composer binary to <em>/usr/local/bin/composer</em> with this command:</p>
<pre><code>sudo mv composer.phar /usr/local/bin/composer
</code></pre><p>Be sure you run this command to make the <code>composer</code> binary executable:</p>
<pre><code>sudo chmod +x /usr/local/bin/composer
</code></pre><p>Finally, add the <em>/usr/local/bin</em> directory to your environment <code>PATH</code> by appending this line to your _~/.bash<em>profile</em> file:</p>
<pre><code>PATH=/usr/local/bin:$PATH
</code></pre><p>You should now be able to execute <code>composer</code> in your terminal application to see a list of Composer options:</p>
<h2 id="Use-Composer"><a href="#Use-Composer" class="headerlink" title="Use Composer"></a>Use Composer</h2><p>Navigate to your project’s topmost directory in your terminal application and run this command once for each PHP component:</p>
<pre><code>composer require vendor/package
</code></pre><p>Replace <code>_vendor/package_</code> with the component’s vendor and package names. To install the Flysystem component, for example, run this command:</p>
<pre><code>composer require league/flysystem
</code></pre><p>This command instructs Composer to find and install the PHP component’s most stable version. It also instructs Composer to update the component up to, but not including, the component’s next major version. The previous example, as of October 2014, installs Flysystem version <code>0.5.9</code>, and it will update the Flysystem component up to, but not including, version <code>1.*</code>.</p>
<p>You can review the result of this command in the newly created or updated <em>composer.json</em> file in your project’s topmost directory. This command also creates a <em>composer.lock</em> file. Commit both of these files into your version control system.</p>
<p><em>composer.lock</em>  file lists all of the PHP components used by our project and the components’ exact version numbers (including major, minor, and patch numbers). This effectively locks our project to these specific PHP component versions.</p>
<p>If a <em>composer.lock</em> file is present, Composer downloads the specific PHP component versions listed in the <em>composer.lock</em> file regardless of the component’s latest available version on Packagist. You should version control the <em>composer.lock</em> file and distribute it to your team members so they can use the same PHP component versions as you.</p>
<p>The one downside with the <em>composer.lock</em> file is that <code>composer install</code> will not install versions newer than those listed in the <em>composer.lock</em> file. If you do need to download newer component versions <em>and</em> update your <em>composer.lock</em> file, use <code>composer update</code>. The <code>composer update</code> command updates your components to their latest stable versions and also updates the <em>composer.lock</em> file with new PHP component version numbers.</p>
<h2 id="Autoloading-PHP-components"><a href="#Autoloading-PHP-components" class="headerlink" title="Autoloading PHP components"></a>Autoloading PHP components</h2><p>Now that our project’s PHP components are installed with Composer, how do we use them? Luckily for us, when Composer downloads the PHP components it also creates a single PSR-compatible autoloader for all of our project dependencies. All we have to do  is <code>require</code> Composer’s autoloader at the top of the <em>scan.php</em> file:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">require &apos;vendor/autoload.php&apos;;</div></pre></td></tr></table></figure>
<p>Composer’s autoloader is just a PHP file named <em>autoload.php</em> located inside the <em>vendor/</em> directory. When Composer downloads each PHP component, Composer inspects each component’s own <em>composer.json</em> file to determine how the component prefers to be autoloaded and, with this information, creates a local PSR-compatible autoloader for it. Ultimately, we can instantiate any of our project’s PHP components and they are autoloaded on-demand!</p>
<h2 id="Create-PHP-Components"><a href="#Create-PHP-Components" class="headerlink" title="Create PHP Components"></a>Create PHP Components</h2><h3 id="Filesystem-Organization"><a href="#Filesystem-Organization" class="headerlink" title="Filesystem Organization"></a>Filesystem Organization</h3><p>PHP components have largely standardized on this filesystem structure:</p>
<ul>
<li><p>src/</p>
<p>  This directory contains the component’s source code (e.g., PHP class files).</p>
</li>
<li><p>tests/</p>
<p>  This directory contains the component’s tests. We will not use this directory in this example.</p>
</li>
<li><p>composer.json</p>
<p>  This is the Composer configuration file. This file describes the component and tells Composer’s autoloader to map your component’s PSR-4 namespace to the src/ directory.</p>
</li>
<li><p>README.md</p>
<p>  This Markdown file provides helpful information about this component, including its name, description, author, usage, contributor guidelines, software license, and credits.</p>
</li>
<li><p>CONTRIBUTING.md</p>
<p>  This Markdown file describes how others can contribute to this component.</p>
</li>
<li><p>LICENSE</p>
<p>  This plain-text file contains the component’s software license.</p>
</li>
<li><p>CHANGELOG.md</p>
<p>  This Markdown file lists changes introduced in each new component version.</p>
</li>
</ul>
<h3 id="The-composer-json-File"><a href="#The-composer-json-File" class="headerlink" title="The composer.json File"></a>The composer.json File</h3><p>The <em>composer.json</em> file is <em>required</em> and must contain valid JSON. It includes information used by Composer to find, install, and autoload the PHP component. It also contains information for the component’s Packagist directory listing.</p>
<p>It includes all of the composer.json properties that I use most often for my own PHP components.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"name"</span>: <span class="string">"modernphp/scanner"</span>,</div><div class="line">    <span class="attr">"description"</span>: <span class="string">"Scan URLs from a CSV file and report inaccessible URLs"</span>,</div><div class="line">    <span class="attr">"keywords"</span>: [<span class="string">"url"</span>, <span class="string">"scanner"</span>, <span class="string">"csv"</span>],</div><div class="line">    <span class="attr">"homepage"</span>: <span class="string">"http://example.com"</span>,</div><div class="line">    <span class="attr">"license"</span>: <span class="string">"MIT"</span>,</div><div class="line">    <span class="attr">"authors"</span>: [</div><div class="line">        &#123;</div><div class="line">            <span class="attr">"name"</span>: <span class="string">"Josh Lockhart"</span>,</div><div class="line">            <span class="attr">"homepage"</span>: <span class="string">"https://github.com/codeguy"</span>,</div><div class="line">            <span class="attr">"role"</span>: <span class="string">"Developer"</span></div><div class="line">        &#125;</div><div class="line">    ],</div><div class="line">    <span class="attr">"support"</span>: &#123;</div><div class="line">        <span class="attr">"email"</span>: <span class="string">"help@example.com"</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"require"</span>: &#123;</div><div class="line">        <span class="attr">"php"</span> : <span class="string">"&gt;=5.4.0"</span>,</div><div class="line">        <span class="attr">"guzzlehttp/guzzle"</span>: <span class="string">"~5.0"</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"require-dev"</span>: &#123;</div><div class="line">        <span class="attr">"phpunit/phpunit"</span>: <span class="string">"~4.3"</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"suggest"</span>: &#123;</div><div class="line">        <span class="attr">"league/csv"</span>: <span class="string">"~6.0"</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"autoload"</span>: &#123;</div><div class="line">        <span class="attr">"psr-4"</span>: &#123;</div><div class="line">            <span class="attr">"Oreilly\\ModernPHP\\"</span>: <span class="string">"src/"</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This is admittedly a lot to digest, so let’s step through each composer.json property in detail:</p>
<ul>
<li><p>name</p>
<p>  This is the component’s vendor and package name, separated with a / character. This value is displayed on Packagist.</p>
</li>
<li><p>description</p>
<p>  This contains a few sentences that succinctly describe the component. This description is displayed on Packagist.</p>
</li>
<li><p>keywords</p>
<p>  This contains an appropriate number of keywords that describe the component. These keywords help others find this component on Packagist.</p>
</li>
<li><p>homepage</p>
<p>  This is the URL of the component’s website.</p>
</li>
<li><p>license</p>
<p>  This is the software license with which the PHP component is released. I prefer to use the MIT Public License. You can read more about software licenses at <a href="http://choosealicense.com" target="_blank" rel="external">http://choosealicense.com</a>. Remember to always release your code with a license.</p>
</li>
<li><p>authors</p>
<p>  This is an array of information for each project author. You should include at least a name and URL for each author.</p>
</li>
<li><p>support</p>
<p>  This is how the component’s users find technical support. I prefer to include an email address and support forum URL. You could also list an IRC channel, for example.</p>
</li>
<li><p>require</p>
<p>  This lists the PHP component’s own component dependencies. You should list each dependency’s vendor/package name and minimum version number. I also like to list the minimum PHP version required by this component. All dependencies listed beneath this property are installed for both development and production project installations.</p>
</li>
<li><p>require-dev</p>
<p>  This acts like the require property, but it lists only the dependencies required to develop this component. For example, I often list phpunit as a dev dependency so that other component contributors can write and run tests. These dependencies are installed only during development. They are not installed in production projects.</p>
</li>
<li><p>suggest</p>
<p>  This acts like the require property, but it merely suggests other components because they may be useful when used with our component. Unlike the require property, this object’s values are free text fields that describe each suggested component. Composer does not install suggested components.</p>
</li>
<li><p>autoload</p>
<p>  This tells the Composer autoloader how to autoload this component. I recommend you use the PSR-4 autoloader, as demonstrated in Example 4-2. Beneath the <code>psr-4</code> property, you map the component’s namespace prefix to a filesystem path relative to the component’s root directory. This makes our component compatible with a standard PSR-4 autoloader. In Example 4-2, I map the <code>Oreilly\ModernPHP</code> namespace to the <em>src/</em> directory. The mapping’s namespace must end with two back slash characters (<code>\\</code>) to avoid conflicts with other components that use a namespace with a similar sequence of characters. Based on the example mapping, if we instantiate a hypothetical <code>Oreilly\ModernPHP\Url\Scanner</code> class, Composer will autoload the PHP class file at <em>src/Url/Scanner.php</em>.</p>
</li>
</ul>
<p>The <em>README</em> file is often the component’s first introduction to its users. This is especially true for components hosted on GitHub and Bitbucket. Therefore, it’s important that the component’s <em>README</em> file provides, at a minimum, this information:<em> Component name and description </em> Install instructions:</p>
<ul>
<li>Usage instructions</li>
<li>Testing instructions</li>
<li>Contributing instructions</li>
<li>Support resources</li>
<li>Author credits</li>
<li>Software license</li>
</ul>
<h3 id="Component-Implementation"><a href="#Component-Implementation" class="headerlink" title="Component Implementation"></a>Component Implementation</h3><p>And now we arrive at the component’s meat and potatoes—its implementation. This is where you write the PHP classes, interfaces, and traits that form the PHP component. What classes you write, and how many, depends entirely on the PHP component’s purpose. However, all component classes, interfaces, and traits must live in the <em>src/</em> directory and exist beneath the component’s namespace prefix listed in the <em>composer.json</em> file.</p>
<p>For this demonstration, I’ll create a single PHP class named <code>Scanner</code> that exists beneath the <code>Url</code> subnamespace beneath the <code>Oreilly\ModernPHP</code> namespace listed in the <em>composer.json</em> file. The <code>Scanner</code> class file lives at <em>src/Url/Scanner.php</em>. The <code>Scanner</code> class implements the same logic as our earlier URL scanner example application, except it encapsulates the URL scanning behavior in a PHP class:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">namespace Oreilly\ModernPHP\Url;</div><div class="line"></div><div class="line">class Scanner</div><div class="line">&#123;</div><div class="line">    /**</div><div class="line">     * @var array An array of URLs</div><div class="line">     */</div><div class="line">    protected $urls;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * @var \GuzzleHttp\Client</div><div class="line">     */</div><div class="line">    protected $httpClient;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * Constructor</div><div class="line">     * @param array $urls An array of URLs to scan</div><div class="line">     */</div><div class="line">    public function __construct(array $urls)</div><div class="line">    &#123;</div><div class="line">        $this-&gt;urls = $urls;</div><div class="line">        $this-&gt;httpClient = new \GuzzleHttp\Client();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * Get invalid URLs</div><div class="line">     * @return array</div><div class="line">     */</div><div class="line">    public function getInvalidUrls()</div><div class="line">    &#123;</div><div class="line">        $invalidUrls = [];</div><div class="line">        foreach ($this-&gt;urls as $url) &#123;</div><div class="line">            try &#123;</div><div class="line">                $statusCode = $this-&gt;getStatusCodeForUrl($url);</div><div class="line">            &#125; catch (\Exception $e) &#123;</div><div class="line">                $statusCode = 500;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            if ($statusCode &gt;= 400) &#123;</div><div class="line">                array_push($invalidUrls, [</div><div class="line">                    &apos;url&apos; =&gt; $url,</div><div class="line">                    &apos;status&apos; =&gt; $statusCode</div><div class="line">                ]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        return $invalidUrls;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * Get HTTP status code for URL</div><div class="line">     * @param string $url The remote URL</div><div class="line">     * @return int The HTTP status code</div><div class="line">     */</div><div class="line">    protected function getStatusCodeForUrl($url)</div><div class="line">    &#123;</div><div class="line">        $httpResponse = $this-&gt;httpClient-&gt;options($url);</div><div class="line"></div><div class="line">        return $httpResponse-&gt;getStatusCode();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Instead of parsing and iterating a CSV file, we inject an array of URLs into the <code>Scanner</code> class constructor. We want our URL scanner class to be as generic as possible. If we demand a CSV file, we inherently limit our component’s usefulness. If we accept an array of URLs, we let the end user decide how to fetch an array of URLs (from a PHP array, a CSV file, an iterator, etc). That being said, we still <em>recommend</em> the <code>league/csv</code> component because it can be helpful for developers using our component. We include the <code>league/csv</code> component in the <em>composer.json</em> manifest’s <code>suggest</code> property.</p>
<p>The <code>Scanner</code> class has a hard dependency on the <code>guzzlehttp/guzzle</code> component. However, we isolate each URL’s HTTP request in the <code>getStatusCodeForUrl()</code> method. This lets us stub (or <em>override</em>) this method’s implementation in our component’s unit tests so that our tests do not rely on a working Internet connection.</p>
<h3 id="Packagist-Submission"><a href="#Packagist-Submission" class="headerlink" title="Packagist Submission"></a>Packagist Submission</h3><p>Now we’re ready to submit the component to Packagist. If you don’t use GitHub, go ahead and <a href="https://packagist.org/register/" target="_blank" rel="external">create a Packagist account</a>. You can also log in to Packagist with your GitHub credentials.</p>
<p>Once logged in, click the big green Submit Package button at the top right of the website. Enter the full Git repository URL into the Repository URL text field and click the Check button. Packagist verifies the repository URL and prompts you to confirm your submission. Click Submit to finalize your component submission.</p>
<p>You’ll notice it pulls the component name, description, keywords, dependencies, and suggestions from the component’s <em>composer.json</em> file. You’ll also notice that it shows the repository branches and tags, too. Packagist establishes a direct correlation between repository tags and semantic version numbers. This is why I recommend your repository tags be valid version numbers like <code>1.0.0</code>, <code>1.1.0</code>, and so on. However, we still have that big red alert message that reads:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">This package is not auto-updated. Please set up the GitHub Service Hook for</div><div class="line">Packagist so that it gets updated whenever you push!</div></pre></td></tr></table></figure>
<p>We can activate a GitHub or Bitbucket hook that notifies Packagist whenever the component repository is updated. Learn how to setup this repository hook at <a href="https://packagist.org/profile/" target="_blank" rel="external"><em>https://packagist.org/profile/</em></a>.</p>
<h3 id="Using-the-Component"><a href="#Using-the-Component" class="headerlink" title="Using the Component"></a>Using the Component</h3><p>We’re done! Now anyone can install the URL scanner component with Composer and use it in their PHP applications. Run this command in your terminal to install the URL scanner component with Composer:</p>
<pre><code>composer require modernphp/scanner
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">require &apos;vendor/autoload.php&apos;;</div><div class="line"></div><div class="line">$urls = [</div><div class="line">    &apos;http://www.apple.com&apos;,</div><div class="line">    &apos;http://php.net&apos;,</div><div class="line">    &apos;http://sdfssdwerw.org&apos;</div><div class="line">];</div><div class="line">$scanner = new \Oreilly\ModernPHP\Url\Scanner($urls);</div><div class="line">print_r($scanner-&gt;getInvalidUrls());</div></pre></td></tr></table></figure>
        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2017-11-05T08:22:17.000Z" itemprop="dateUpdated">2017-11-05 16:22:17</time>
</span><br>


        
        这里可以写作者留言，标签和 hexo 中所有变量及辅助函数等均可调用，示例：<a href="/PHP/2015-05-28-php-components.html" target="_blank" rel="external">http://blog.inching.org/PHP/2015-05-28-php-components.html</a>
        
    </div>
    <footer>
        <a href="http://blog.inching.org">
            <img src="/img/avatar.png" alt="Cody Fei">
            Cody Fei
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/">php</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tutorial/">tutorial</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.inching.org/PHP/2015-05-28-php-components.html&title=《PHP Components》 — Balance&pic=http://blog.inching.org/img/avatar.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.inching.org/PHP/2015-05-28-php-components.html&title=《PHP Components》 — Balance&source=See 《Modern PHP》 and 《Learning PHP, MySQL &amp; JavaScript, 4th Edition》.
The..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.inching.org/PHP/2015-05-28-php-components.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《PHP Components》 — Balance&url=http://blog.inching.org/PHP/2015-05-28-php-components.html&via=http://blog.inching.org" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://blog.inching.org/PHP/2015-05-28-php-components.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/PHP/2015-05-29-php-database.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">PHP Database</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/PHP/2015-05-27-php-mysql.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">PHP MySQL</h4>
      </a>
    </div>
  
</nav>



    











</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.JPG" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.JPG" data-alipay="/img/alipay.JPG">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top" style="display:none">
        

        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>footer.license</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>Cody Fei &copy; 2012 - 2017</span>
            <span style="display:none">
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.inching.org/PHP/2015-05-28-php-components.html&title=《PHP Components》 — Balance&pic=http://blog.inching.org/img/avatar.png" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.inching.org/PHP/2015-05-28-php-components.html&title=《PHP Components》 — Balance&source=See 《Modern PHP》 and 《Learning PHP, MySQL &amp; JavaScript, 4th Edition》.
The..." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.inching.org/PHP/2015-05-28-php-components.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《PHP Components》 — Balance&url=http://blog.inching.org/PHP/2015-05-28-php-components.html&via=http://blog.inching.org" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://blog.inching.org/PHP/2015-05-28-php-components.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACJ0lEQVR42u3ay26DQAwF0Pz/T9NtpBZybdNWzBxWVUQCZxauX69XfB1v1/fPr++//u7752d33nZhYGA8lnFcXpNHXrPPfu3689PnYmBgbMC4fonrcNl8cMxLDggDAwOj+neey1WPDwMDA2Pyc9X0MU9AMTAwMPIiNm+x5T2xf6jFMTAwHsiopnF/+fevzDcwMDAexTiKVzLOrKZ6SSPvw1thYGAszcgDXL5s0Vu/qAZcDAyMfRhJWdhbvKgWtJPfwcDAWJvxe8G0ek9vjPrD/w0MDIxFGeVhYYDstc96IRsDA2MfRh7gJk266CVax4qBgbEqI0nXeuGyfH6TNQ4MDIxtGNewXjNuHrKjMhsDA2MDxmTpYdQaazXsTkeYGBgYizKqRWzeaKuORW9LEzEwMBZl5Old3vSvhs7q6BQDA2M3xl3JXL7m1UtAy8sWGBgYCzEmr5LcmaeASal8GnYxMDA2YCQt+MnCRG8Vo5CYYmBgLM3IE8TegHPyouUiFgMDY1FGdQCQn80klJfXyDAwMLZhVFv/+SAhZ/TadhgYGDsweksS1fFANbnMjwMDA2NVxlG8qkPHPCmclMoYGBhrM6rlYmGg2ALnRXWz9MXAwHgso7eSVWX0jixp/2FgYOzDuHcAmRxEL+37UMpiYGBgxKQ8QM/DOgYGBkb+KskqRjUQF8I9BgbGBox8GJB/a5L2lZfMMDAwlmbkD+gVscmhTDAYGBhLM74AYZ2TYURJwJoAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="/js/main.min.js?v=1.6.17"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.6.17" async></script>










</body>
</html>
